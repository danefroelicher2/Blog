<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dane's Blog</title>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #1a1a1a;
            --bg-secondary: #2d2d2d;
            --bg-tertiary: #3a3a3a;
            --text-primary: #e0e0e0;
            --text-secondary: #b0b0b0;
            --text-muted: #808080;
            --accent: #4a90e2;
            --accent-hover: #357abd;
            --border: #404040;
            --shadow: rgba(0, 0, 0, 0.3);

        }

        body {
            transition: background-color 0.5s ease;
        }


        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background-color: var(--bg-primary);
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 40px 0;
            border-bottom: 1px solid var(--border);
            margin-bottom: 40px;
            transition: all 0.5s ease;
            position: relative;
        }


        h1 {
            font-size: 2.5rem;
            font-weight: 300;
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
            font-weight: 300;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 40px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .admin-status {
            display: flex;
            align-items: center;
            gap: 10px;
            background: var(--bg-secondary);
            padding: 8px 16px;
            border-radius: 6px;
            border: 1px solid var(--border);
            margin-bottom: 20px;
            justify-content: center;
        }

        .admin-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4ade80;
        }

        .admin-text {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .error-message {
            color: #ef4444;
            font-size: 0.9rem;
            margin-top: 8px;
            display: none;
        }

        .header-admin-indicator {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--bg-secondary);
            color: var(--text-secondary);
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            border: 1px solid var(--border);
            display: none;
        }

        .header-admin-indicator.active {
            display: block;
        }


        .timeout-warning {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--bg-secondary);
            border: 2px solid #f59e0b;
            border-radius: 12px;
            padding: 20px;
            z-index: 2000;
            min-width: 300px;
            text-align: center;
            box-shadow: 0 20px 40px var(--shadow);
            display: none;
        }

        .timeout-warning h3 {
            color: #f59e0b;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .timeout-warning p {
            color: var(--text-secondary);
            margin-bottom: 15px;
        }

        .timeout-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .no-select {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        /* Admin Toolbar */
        .admin-toolbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(90deg, var(--accent), var(--accent-hover));
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1500;
            box-shadow: 0 2px 20px rgba(124, 58, 237, 0.3);
            transform: translateY(-100%);
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .admin-toolbar.active {
            transform: translateY(0);
        }


        .admin-toolbar-left,
        .admin-toolbar-center,
        .admin-toolbar-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .admin-toolbar .admin-logo {
            color: white;
            font-weight: 600;
            font-size: 1rem;
        }

        .admin-toolbar .admin-stats {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.85rem;
            display: flex;
            gap: 20px;
        }

        .admin-toolbar button {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 6px 12px;
            font-size: 0.85rem;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .admin-toolbar button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-1px);
        }

        /* Footer */
        footer {
            margin-top: 60px;
            padding: 40px 0 20px;
            border-top: 1px solid var(--border);
            text-align: center;
            color: var(--text-muted);
        }

        .footer-admin-link {
            color: var(--text-muted);
            text-decoration: none;
            font-size: 0.85rem;
            opacity: 0.6;
            transition: opacity 0.3s ease;
        }

        .footer-admin-link:hover {
            opacity: 1;
            color: var(--accent);
        }


        /* Post Actions */
        .post-actions {
            position: absolute;
            top: 15px;
            right: 15px;
            display: none;
            gap: 8px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .post:hover .post-actions {
            display: flex;
            opacity: 1;
        }


        .post {
            position: relative;
        }

        .post-action-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .post-action-btn:hover {
            background: var(--accent-hover);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .post-action-btn.edit {
            background: #10b981;
        }

        .post-action-btn.edit:hover {
            background: #059669;
        }

        .post-action-btn.delete {
            background: #ef4444;
        }

        .post-action-btn.delete:hover {
            background: #dc2626;
        }

        /* Post Analytics */
        .post-analytics {
            display: none;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid var(--border);
            font-size: 0.8rem;
            color: var(--text-muted);
            gap: 15px;
        }


        .analytics-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .analytics-icon {
            font-size: 0.7rem;
        }

        /* Admin Dashboard */
        .admin-dashboard {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            display: none;
            animation: slideDownSimple 0.3s ease;
        }

        .admin-dashboard.active {
            display: block;
        }

        .dashboard-title {
            color: var(--text-primary);
            font-size: 1.3rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: var(--bg-tertiary);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border);
            text-align: center;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--accent);
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .dashboard-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .dashboard-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }

        .dashboard-btn:hover {
            background: var(--accent-hover);
            transform: translateY(-1px);
        }

        .dashboard-btn.export {
            background: #10b981;
        }

        .dashboard-btn.export:hover {
            background: #059669;
        }

        .dashboard-btn.import {
            background: #f59e0b;
        }

        .dashboard-btn.import:hover {
            background: #d97706;
        }

        /* Century Stats Section */
        .century-stats-section {
            margin: 25px 0;
            padding: 20px 0;
            border-top: 1px solid var(--border);
        }

        .century-stats-title {
            color: var(--text-primary);
            font-size: 1.1rem;
            margin-bottom: 15px;
            font-weight: 500;
        }

        .century-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 12px;
        }

        .century-stat-item {
            background: var(--bg-tertiary);
            padding: 12px;
            border-radius: 6px;
            border: 1px solid var(--border);
            text-align: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .century-stat-item:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--shadow);
        }

        .century-stat-value {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--accent);
            margin-bottom: 4px;
        }

        .century-stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .century-stat-empty {
            opacity: 0.6;
        }

        /* Drafts Grid */
        .drafts-container {
            margin-top: 20px;
        }

        .drafts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .draft-card {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .draft-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .draft-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
            line-height: 1.3;
        }

        .draft-content {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.4;
            margin-bottom: 12px;
            max-height: 60px;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
        }

        .draft-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .draft-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .draft-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .draft-btn.edit {
            background: var(--accent);
            color: white;
        }

        .draft-btn.edit:hover {
            background: #2563eb;
        }

        .draft-btn.publish {
            background: #10b981;
            color: white;
        }

        .draft-btn.publish:hover {
            background: #059669;
        }

        .draft-btn.delete {
            background: #ef4444;
            color: white;
        }

        .draft-btn.delete:hover {
            background: #dc2626;
        }

        /* Import Section */
        .import-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
            display: none;
        }

        .import-section.active {
            display: block;
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
            margin-right: 15px;
        }

        .file-input {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-input-label {
            background: var(--bg-tertiary);
            border: 2px dashed var(--border);
            padding: 15px 25px;
            border-radius: 6px;
            display: inline-block;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-secondary);
        }

        .file-input-label:hover {
            border-color: var(--accent);
            color: var(--text-primary);
        }

        /* Confirmation Dialog */
        .confirmation-dialog {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--bg-secondary);
            border: 2px solid #ef4444;
            border-radius: 12px;
            padding: 25px;
            z-index: 2000;
            min-width: 350px;
            text-align: center;
            box-shadow: 0 20px 40px var(--shadow);
            display: none;
        }

        .confirmation-dialog.active {
            display: block;
            animation: slideDown 0.3s ease;
        }

        .confirmation-dialog h3 {
            color: #ef4444;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .confirmation-dialog p {
            color: var(--text-secondary);
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .confirmation-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        /* Security Features */
        .rate-limit-warning {
            background: #dc2626;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            text-align: center;
            display: none;
        }

        .rate-limit-warning.active {
            display: block;
            animation: slideDownSimple 0.3s ease;
        }

        .security-indicator {
            position: fixed;
            top: 10px;
            left: 10px;
            background: var(--accent);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.7rem;
            z-index: 1000;
            display: none;
        }

        .security-indicator.active {
            display: block;
        }

        .activity-log {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
        }

        .activity-log h4 {
            color: var(--text-primary);
            margin-bottom: 15px;
            font-size: 1rem;
        }

        .log-entry {
            background: var(--bg-tertiary);
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 4px;
            font-size: 0.85rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .log-action {
            color: var(--text-primary);
            font-weight: 500;
        }

        .log-time {
            color: var(--text-muted);
            font-size: 0.75rem;
        }

        .log-ip {
            color: var(--accent);
            font-family: monospace;
            font-size: 0.75rem;
        }

        .security-status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .security-stat {
            background: var(--bg-tertiary);
            padding: 12px;
            border-radius: 6px;
            text-align: center;
            border: 1px solid var(--border);
        }

        .security-stat.warning {
            border-color: #f59e0b;
            background: rgba(245, 158, 11, 0.1);
        }

        .security-stat.danger {
            border-color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }

        .security-stat-value {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--accent);
            margin-bottom: 4px;
        }

        .security-stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        /* Animations */
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translate(-50%, -50%) translateY(-20px) scale(0.9);
            }

            to {
                opacity: 1;
                transform: translate(-50%, -50%) translateY(0) scale(1);
            }
        }

        @keyframes slideDownSimple {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.7;
            }
        }



        /* Enhanced modal animations */
        .modal {
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            animation: slideDown 0.3s ease;
        }

        /* Tab System Styles */
        .tab-container {
            margin-bottom: 40px;
        }

        .tab-nav {
            display: flex;
            justify-content: center;
            gap: 0;
            background: var(--bg-secondary);
            border-radius: 8px 8px 0 0;
            padding: 0;
            margin: 0 auto;
            max-width: 400px;
            overflow: hidden;
            box-shadow: 0 2px 8px var(--shadow);
        }

        .tab-btn {
            background: transparent;
            border: none;
            padding: 15px 30px;
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            position: relative;
            flex: 1;
            min-width: 0;
        }

        .tab-btn:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            transform: none;
        }

        .tab-btn.active {
            background: var(--bg-tertiary);
            color: var(--accent);
            border-bottom-color: var(--accent);
            font-weight: 600;
        }

        .tab-btn.active::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--accent);
        }


        /* Tab Content */
        .tab-content {
            min-height: 400px;
        }

        .tab-pane {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-pane.active {
            display: block;
        }

        .timeline-placeholder {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
            background: var(--bg-secondary);
            border-radius: 12px;
            border: 1px solid var(--border);
            margin-top: 20px;
        }

        .timeline-placeholder h3 {
            font-size: 1.3rem;
            margin-bottom: 10px;
            font-weight: 400;
            color: var(--text-secondary);
        }

        .timeline-placeholder p {
            font-size: 1rem;
            line-height: 1.6;
        }

        /* Timeline Tab Specific Styles */
        .timeline-container {
            max-width: 100%;
        }

        .timeline-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: var(--bg-secondary);
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .timeline-header h3 {
            font-size: 1.4rem;
            margin-bottom: 8px;
            color: var(--text-primary);
            font-weight: 500;
        }

        .timeline-header p {
            color: var(--text-secondary);
            font-size: 1rem;
            margin: 0;
        }

        .timeline-accordion {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .century-section {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .century-section:hover {
            border-color: var(--accent);
            box-shadow: 0 2px 8px var(--shadow);
        }

        .century-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 20px;
            cursor: pointer;
            background: var(--bg-secondary);
            transition: background-color 0.3s ease;
            user-select: none;
        }

        .century-header:hover {
            background: var(--bg-tertiary);
        }

        .century-header.active {
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border);
        }

        .century-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
        }

        .century-arrow {
            font-size: 0.9rem;
            color: var(--text-secondary);
            transition: transform 0.3s ease;
            margin-left: 10px;
        }

        .century-header.active .century-arrow {
            transform: rotate(180deg);
        }

        .century-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            background: var(--bg-tertiary);
        }

        .century-content.expanded {
            max-height: 500px;
            /* Will be adjusted by JavaScript */
        }

        .century-inner {
            padding: 20px;
        }

        .century-empty {
            text-align: center;
            color: var(--text-muted);
            font-style: italic;
            font-size: 0.95rem;
            padding: 15px 0;
        }

        .century-posts {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .timeline-post-item {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 12px 16px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .timeline-post-item:hover {
            background: var(--bg-secondary);
            border-color: var(--accent);
            transform: translateX(4px);
            box-shadow: 0 4px 12px var(--shadow);
        }

        .timeline-post-title {
            color: var(--text-primary);
            text-decoration: none;
            font-size: 1rem;
            font-weight: 500;
            line-height: 1.4;
            margin: 0;
            display: block;
            word-wrap: break-word;
            overflow-wrap: break-word;
            hyphens: auto;
        }

        .timeline-post-title:hover {
            color: var(--accent);
        }

        .timeline-post-meta {
            color: var(--text-muted);
            font-size: 0.85rem;
            margin-top: 4px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .timeline-post-date {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .timeline-post-words {
            display: flex;
            align-items: center;
            gap: 4px;
        }


        .timeline-post-actions {
            display: none;
            margin-top: 8px;
            gap: 8px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .timeline-post:hover .timeline-post-actions {
            display: flex;
            opacity: 1;
        }


        .timeline-action-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .timeline-action-btn:hover {
            background: var(--accent-hover);
            transform: translateY(-1px);
        }

        .timeline-action-btn.edit {
            background: #10b981;
        }

        .timeline-action-btn.edit:hover {
            background: #059669;
        }

        .timeline-action-btn.delete {
            background: #ef4444;
        }

        .timeline-action-btn.delete:hover {
            background: #dc2626;
        }

        /* Discourse Post Styles (reuse timeline styles for consistency) */
        .discourse-post-item {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 12px 16px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            margin-bottom: 8px;
        }

        .discourse-post-item:hover {
            background: var(--bg-secondary);
            border-color: var(--accent);
            transform: translateX(4px);
            box-shadow: 0 4px 12px var(--shadow);
        }

        .discourse-post-title {
            color: var(--text-primary);
            text-decoration: none;
            font-size: 1rem;
            font-weight: 500;
            line-height: 1.4;
            margin: 0;
            display: block;
            word-wrap: break-word;
            overflow-wrap: break-word;
            hyphens: auto;
        }

        .discourse-post-title:hover {
            color: var(--accent);
        }

        .discourse-post-meta {
            color: var(--text-muted);
            font-size: 0.85rem;
            margin-top: 4px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .discourse-post-date {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .discourse-post-words {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .discourse-post-actions {
            display: none;
            margin-top: 8px;
            gap: 8px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .discourse-post-item:hover .discourse-post-actions {
            display: flex;
            opacity: 1;
        }

        .discourse-posts {
            padding: 16px 0;
        }

        .discourse-posts h4 {
            color: var(--text-primary);
            margin-bottom: 16px;
            font-size: 1.2rem;
        }

        /* Discourses Container Styles */
        .discourses-container {
            max-width: 100%;
            padding-top: 20px;
        }


        /* Subtab Navigation Styles */
        .subtab-nav {
            display: flex;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 8px;
            margin-bottom: 35px;
            margin-top: 0;
            overflow-x: auto;
            box-shadow: 0 4px 20px var(--shadow);
            backdrop-filter: blur(10px);
            position: relative;
        }

        .subtab-nav::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);
            border-radius: 10px;
            z-index: -1;
        }

        .subtab-btn {
            flex: 1;
            min-width: max-content;
            background: transparent;
            color: var(--text-secondary);
            border: none;
            padding: 14px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.92rem;
            font-weight: 500;
            white-space: nowrap;
            position: relative;
            overflow: hidden;
            letter-spacing: 0.3px;
        }

        .subtab-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.6s;
        }

        .subtab-btn:hover::before {
            left: 100%;
        }

        .subtab-btn:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
        }

        .subtab-btn.active {
            background: linear-gradient(135deg, var(--accent) 0%, var(--accent-hover) 100%);
            color: white;
            box-shadow: 0 4px 20px rgba(74, 144, 226, 0.3);
            font-weight: 600;
            transform: translateY(-1px);
        }

        .subtab-btn.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 30px;
            height: 2px;
            background: white;
            transform: translateX(-50%);
            border-radius: 2px;
            animation: slideUp 0.3s ease;
        }

        .subtab-btn.active:hover {
            background: linear-gradient(135deg, var(--accent-hover) 0%, var(--accent) 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 24px rgba(74, 144, 226, 0.4);
        }

        @keyframes slideUp {
            from {
                width: 0;
                opacity: 0;
            }

            to {
                width: 30px;
                opacity: 1;
            }
        }

        /* Subtab Content Styles */
        .subtab-content {
            min-height: 400px;
            position: relative;
        }

        .subtab-pane {
            display: none;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .subtab-pane.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
            animation: subtabFadeIn 0.4s ease-out;
        }

        @keyframes subtabFadeIn {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Enhanced Placeholder Content Styles */
        .subtab-placeholder {
            text-align: center;
            padding: 80px 40px;
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);
            border: 1px solid var(--border);
            border-radius: 16px;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
        }

        .subtab-placeholder::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(74, 144, 226, 0.05) 0%, transparent 70%);
            animation: subtabGlow 4s ease-in-out infinite alternate;
        }

        @keyframes subtabGlow {
            from {
                opacity: 0.3;
                transform: scale(0.8);
            }

            to {
                opacity: 0.6;
                transform: scale(1.2);
            }
        }

        .subtab-placeholder h4 {
            font-size: 1.8rem;
            margin-bottom: 16px;
            color: var(--text-primary);
            font-weight: 600;
            position: relative;
            z-index: 2;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .subtab-placeholder p {
            color: var(--text-muted);
            font-size: 1.15rem;
            margin: 0;
            position: relative;
            z-index: 2;
            font-style: italic;
            letter-spacing: 0.5px;
        }

        /* Subtab icon styling */
        .subtab-btn .subtab-icon {
            display: inline-block;
            margin-right: 8px;
            font-size: 1.1em;
            opacity: 0.8;
            transition: all 0.3s ease;
        }

        .subtab-btn:hover .subtab-icon,
        .subtab-btn.active .subtab-icon {
            opacity: 1;
            transform: scale(1.1);
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .admin-toolbar {
                flex-direction: column;
                gap: 10px;
                padding: 10px;
            }

            .admin-toolbar-left,
            .admin-toolbar-center,
            .admin-toolbar-right {
                width: 100%;
                justify-content: center;
            }

            .admin-stats {
                flex-direction: column;
                gap: 5px !important;
                text-align: center;
            }


            /* Tab responsiveness */
            .tab-nav {
                max-width: 100%;
                margin: 0 15px;
                border-radius: 6px 6px 0 0;
            }

            .tab-btn {
                padding: 12px 20px;
                font-size: 0.9rem;
                min-width: 80px;
            }

            .tab-container {
                margin-bottom: 20px;
            }

            /* Subtab responsive design */
            .subtab-nav {
                padding: 4px;
                margin-bottom: 20px;
                border-radius: 8px;
                overflow-x: auto;
                scrollbar-width: thin;
            }

            .subtab-nav::-webkit-scrollbar {
                height: 4px;
            }

            .subtab-nav::-webkit-scrollbar-track {
                background: var(--bg-secondary);
                border-radius: 2px;
            }

            .subtab-nav::-webkit-scrollbar-thumb {
                background: var(--accent);
                border-radius: 2px;
            }

            .subtab-btn {
                padding: 10px 14px;
                font-size: 0.85rem;
                min-width: max-content;
                border-radius: 6px;
                letter-spacing: 0.2px;
            }

            .subtab-content {
                min-height: 300px;
            }

            .subtab-placeholder {
                padding: 50px 20px;
                margin: 15px 0;
                border-radius: 12px;
            }

            .subtab-placeholder h4 {
                font-size: 1.4rem;
                margin-bottom: 12px;
            }

            .subtab-placeholder p {
                font-size: 1rem;
            }

            .timeline-placeholder {
                margin: 10px;
                padding: 40px 15px;
            }

            .timeline-placeholder h3 {
                font-size: 1.1rem;
            }

            .timeline-placeholder p {
                font-size: 0.9rem;
            }

            /* Timeline mobile responsiveness */
            .timeline-header {
                margin-bottom: 20px;
                padding: 15px;
            }

            .timeline-header h3 {
                font-size: 1.2rem;
            }

            .timeline-header p {
                font-size: 0.9rem;
            }

            .century-header {
                padding: 14px 16px;
            }

            .century-title {
                font-size: 1rem;
            }

            .century-inner {
                padding: 15px;
            }

            .century-empty {
                font-size: 0.9rem;
                padding: 12px 0;
            }

            .timeline-post-item {
                padding: 10px 12px;
            }

            .timeline-post-title {
                font-size: 0.95rem;
            }

            .timeline-post-meta {
                font-size: 0.8rem;
                gap: 8px;
                flex-direction: column;
                align-items: flex-start;
            }

            .timeline-action-btn {
                padding: 6px 10px;
                font-size: 0.8rem;
            }


            /* Century stats mobile responsiveness */
            .century-stats-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
                gap: 8px;
            }

            .century-stat-item {
                padding: 8px;
            }

            .century-stat-value {
                font-size: 1.1rem;
            }

            .century-stat-label {
                font-size: 0.75rem;
            }
        }

        button {
            background: var(--accent);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        button:hover {
            background: var(--accent-hover);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: #4a4a4a;
        }

        .btn-draft {
            background: #6366f1;
            color: white;
        }

        .btn-draft:hover {
            background: #4f46e5;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            backdrop-filter: blur(4px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--bg-secondary);
            padding: 30px;
            border-radius: 12px;
            width: 90%;
            /* UPDATED: Increased modal width from 600px to 75vw for larger workspace */
            max-width: 75vw;
            /* UPDATED: Increased modal height from 80vh to 75vh */
            max-height: 75vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px var(--shadow);
        }

        .modal h2 {
            margin-bottom: 20px;
            color: var(--text-primary);
            font-weight: 400;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        input,
        textarea,
        select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            font-size: 1rem;
            font-family: inherit;
        }

        input:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
        }

        textarea {
            /* UPDATED: Removed manual resize to prevent conflicts with auto-expansion */
            resize: none;
            /* UPDATED: Starting height remains 200px */
            min-height: 200px;
            /* UPDATED: Maximum height set to 50vh to allow growth within modal constraints */
            max-height: 50vh;
            font-family: inherit;
            /* UPDATED: Enable auto-expansion behavior */
            overflow-y: auto;
            box-sizing: border-box;
        }

        .modal-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 30px;
        }

        .posts-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .post {
            background: var(--bg-secondary);
            padding: 30px;
            border-radius: 12px;
            border: 1px solid var(--border);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .post:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px var(--shadow);
        }

        .post-header {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }

        .post-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .post-meta {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .post-content {
            color: var(--text-secondary);
            font-size: 1rem;
            line-height: 1.7;
            white-space: pre-wrap;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
        }

        .empty-state h3 {
            font-size: 1.3rem;
            margin-bottom: 10px;
            font-weight: 400;
        }

        .close {
            position: absolute;
            right: 20px;
            top: 20px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-muted);
            padding: 5px;
            border-radius: 4px;
            transition: color 0.3s ease;
        }

        .close:hover {
            color: var(--text-primary);
            background: var(--bg-tertiary);
        }

        /* Post View Modal Styles */
        .post-view-modal-content {
            max-width: 800px;
            max-height: 90vh;
        }

        .post-view-container {
            padding: 0;
        }

        .post-view-header {
            padding: 20px 30px;
            border-bottom: 1px solid var(--border);
            margin-bottom: 0;
        }

        .post-view-title {
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text-primary);
            line-height: 1.3;
        }

        .post-view-meta {
            color: var(--text-muted);
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .post-view-meta-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .post-view-content {
            padding: 30px;
            color: var(--text-secondary);
            font-size: 1.1rem;
            line-height: 1.7;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .post-view-century {
            background: var(--accent);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 500;
        }


        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            h1 {
                font-size: 2rem;
            }

            .modal-content {
                padding: 20px;
                margin: 20px;
                /* RESPONSIVE: On mobile, use full width minus margins */
                width: calc(100% - 40px);
                /* RESPONSIVE: Override desktop max-width for mobile */
                max-width: calc(100% - 40px);
            }

            .post {
                padding: 20px;
            }

            .controls {
                flex-direction: column;
                align-items: center;
            }

            button {
                width: 100%;
                max-width: 300px;
            }

            /* Discourse tablet responsive styles */
            .discourses-container {
                padding-top: 15px;
            }

            .subtab-nav {
                margin-top: 0;
                margin-bottom: 30px;
                padding: 6px;
                border-radius: 10px;
            }
        }

        @media (max-width: 480px) {
            .modal-actions {
                flex-direction: column;
            }

            button {
                width: 100%;
            }

            /* Post view modal mobile responsiveness */
            .post-view-modal-content {
                max-width: 95%;
                max-height: 95vh;
                margin: 10px;
            }

            .post-view-header {
                padding: 15px 20px;
            }

            .post-view-title {
                font-size: 1.4rem;
                margin-bottom: 10px;
            }

            .post-view-meta {
                font-size: 0.9rem;
                gap: 15px;
                flex-direction: column;
                align-items: flex-start;
            }

            .post-view-content {
                padding: 20px;
                font-size: 1rem;
                line-height: 1.6;
            }

            .post-view-century {
                font-size: 0.8rem;
                padding: 3px 10px;
            }

            /* Subtab mobile styles */
            .subtab-nav {
                padding: 3px;
                margin-bottom: 15px;
                box-shadow: 0 1px 8px var(--shadow);
            }

            .subtab-btn {
                padding: 8px 12px;
                font-size: 0.8rem;
                letter-spacing: 0.1px;
                border-radius: 5px;
            }

            .subtab-btn.active::after {
                width: 20px;
                height: 1.5px;
            }

            .subtab-content {
                min-height: 250px;
            }

            .subtab-placeholder {
                padding: 40px 15px;
                margin: 10px 0;
                border-radius: 10px;
            }

            .subtab-placeholder h4 {
                font-size: 1.2rem;
                margin-bottom: 8px;
            }

            .subtab-placeholder p {
                font-size: 0.9rem;
                letter-spacing: 0.3px;
            }

            .discourses-container {
                padding-top: 15px;
            }
        }
    </style>

    <!-- Supabase Client Library -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>
    <div id="securityIndicator" class="security-indicator">üõ°Ô∏è Secured</div>

    <div class="container">
        <header>
            <div id="headerAdminIndicator" class="header-admin-indicator"></div>
            <h1>Dane's Blog</h1>
        </header>

        <!-- Tab Navigation -->
        <div class="tab-container">
            <div class="tab-nav">
                <button class="tab-btn active" data-tab="home">Home</button>
                <button class="tab-btn" data-tab="timeline">Discourse</button>
            </div>
        </div>

        <div id="adminStatus" class="admin-status" style="display: none;">
            <div class="admin-indicator"></div>
            <span class="admin-text">Logged in as Admin</span>
            <button id="logoutBtn" class="btn-danger" style="padding: 4px 12px; font-size: 0.8rem;">Logout</button>
        </div>

        <!-- Admin Toolbar -->
        <div id="adminToolbar" class="admin-toolbar">
            <div class="admin-toolbar-left">
                <span class="admin-logo">üîí Admin Panel</span>
            </div>
            <div class="admin-toolbar-center">
                <div class="admin-stats">
                    <span id="totalPostsCount">Posts: 0</span>
                    <span id="adminSince">Session: 00:00</span>
                </div>
            </div>
            <div class="admin-toolbar-right">
                <button id="dashboardToggle">Dashboard</button>
                <button id="adminCreatePostBtn">Create Post</button>
                <button id="savedDraftsBtn">Saved Drafts</button>
                <button id="adminLogoutBtn" class="btn-danger">Logout</button>
            </div>
        </div>

        <!-- Admin Dashboard -->
        <div id="adminDashboard" class="admin-dashboard">
            <h2 class="dashboard-title">üìä Admin Dashboard</h2>
            <div class="dashboard-stats">
                <div class="stat-card">
                    <div class="stat-value" id="dashTotalPosts">0</div>
                    <div class="stat-label">Total Posts</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="dashTotalWords">0</div>
                    <div class="stat-label">Total Words</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="dashAvgWords">0</div>
                    <div class="stat-label">Avg Words/Post</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="dashDataSize">0KB</div>
                    <div class="stat-label">Storage Used</div>
                </div>
            </div>

            <div class="century-stats-section">
                <h3 class="century-stats-title">Posts by Century</h3>
                <div id="centuryStats" class="century-stats-grid">
                    <!-- Century stats will be populated by JavaScript -->
                </div>
            </div>

        </div>

        <!-- Saved Drafts Dashboard -->
        <div id="savedDraftsDashboard" class="admin-dashboard" style="display: none;">
            <h2 class="dashboard-title">üìù Saved Drafts</h2>
            <div class="drafts-container">
                <div id="draftsGrid" class="drafts-grid">
                    <!-- Drafts will be populated by JavaScript -->
                </div>
                <div id="emptyDraftsState" class="empty-state" style="display: none;">
                    <h3>No drafts yet</h3>
                    <p>Create and save a draft to see it here.</p>
                </div>
            </div>
        </div>

        <!-- Tab Content -->
        <div class="tab-content">
            <!-- Home Tab -->
            <div id="homeTab" class="tab-pane active">
                <div class="controls">
                    <button id="createPostBtn" style="display: none;">Create Post</button>
                </div>

                <div id="postsContainer" class="posts-container">
                    <div class="empty-state">
                        <h3>No posts yet</h3>
                        <p>Click "Create Post" to write your first blog post!</p>
                    </div>
                </div>
            </div>

            <!-- Discourses Tab -->
            <div id="timelineTab" class="tab-pane">
                <div class="discourses-container">
                    <!-- Subtab Navigation -->
                    <div class="subtab-nav">
                        <button class="subtab-btn active" data-subtab="history">History</button>
                        <button class="subtab-btn" data-subtab="philosophy">Philosophy</button>
                        <button class="subtab-btn" data-subtab="literature">Literature</button>
                        <button class="subtab-btn" data-subtab="science">Science</button>
                        <button class="subtab-btn" data-subtab="technology">Technology</button>
                        <button class="subtab-btn" data-subtab="religion">Religion</button>
                    </div>

                    <!-- Subtab Content -->
                    <div class="subtab-content">
                        <!-- History Subtab -->
                        <div id="historySubtab" class="subtab-pane active">
                            <div id="timelineAccordion" class="timeline-accordion">
                                <!-- Accordion sections will be populated by JavaScript -->
                            </div>
                        </div>

                        <!-- Philosophy Subtab -->
                        <div id="philosophySubtab" class="subtab-pane">
                            <div class="subtab-placeholder">
                                <h4>Philosophy</h4>
                                <p>Coming soon</p>
                            </div>
                        </div>

                        <!-- Literature Subtab -->
                        <div id="literatureSubtab" class="subtab-pane">
                            <div class="subtab-placeholder">
                                <h4>Literature</h4>
                                <p>Coming soon</p>
                            </div>
                        </div>

                        <!-- Science Subtab -->
                        <div id="scienceSubtab" class="subtab-pane">
                            <div class="subtab-placeholder">
                                <h4>Science</h4>
                                <p>Coming soon</p>
                            </div>
                        </div>

                        <!-- Technology Subtab -->
                        <div id="technologySubtab" class="subtab-pane">
                            <div class="subtab-placeholder">
                                <h4>Technology</h4>
                                <p>Coming soon</p>
                            </div>
                        </div>

                        <!-- Religion Subtab -->
                        <div id="religionSubtab" class="subtab-pane">
                            <div class="subtab-placeholder">
                                <h4>Religion</h4>
                                <p>Coming soon</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <a href="#" id="footerAdminLink" class="footer-admin-link">Admin</a>
        </footer>
    </div>

    <div id="createPostModal" class="modal">
        <div class="modal-content">
            <button class="close" id="closeModal">&times;</button>
            <h2>Create New Post</h2>
            <form id="postForm">
                <div class="form-group">
                    <label for="postTitle">Title</label>
                    <input type="text" id="postTitle" required placeholder="Enter your post title...">
                </div>
                <!-- Primary Dropdown: Select which tab/category the post belongs to -->
                <div class="form-group">
                    <label for="postCategory">Post Category</label>
                    <select id="postCategory">
                        <option value="">Select a category...</option>
                        <option value="history">History</option>
                        <option value="philosophy">Philosophy</option>
                        <option value="literature">Literature</option>
                        <option value="science">Science</option>
                        <option value="technology">Technology</option>
                        <option value="religion">Religion</option>
                    </select>
                </div>

                <!-- Secondary Dropdown: Year range selection (only shown when History is selected) -->
                <div class="form-group" id="centuryDropdownContainer" style="display: none;">
                    <label for="postCentury">Time Period</label>
                    <select id="postCentury">
                        <option value="">Select a time period...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="postContent">Content</label>
                    <textarea id="postContent" required placeholder="Write your post content here..."></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" id="saveDraftBtn" class="btn-draft">Save Draft</button>
                    <button type="button" id="cancelBtn" class="btn-secondary">Cancel</button>
                    <button type="submit">Post</button>
                </div>
            </form>
        </div>
    </div>

    <div id="adminLoginModal" class="modal no-select">
        <div class="modal-content">
            <button class="close" id="closeAdminModal">&times;</button>
            <h2>Admin Login</h2>
            <form id="adminLoginForm">
                <div class="form-group">
                    <label for="adminPassword">Password</label>
                    <input type="password" id="adminPassword" required placeholder="Enter admin password...">
                    <div id="loginError" class="error-message">Incorrect password. Please try again.</div>
                    <div id="rateLimitWarning" class="rate-limit-warning">
                        Too many failed attempts. Please wait <span id="lockoutTimer">15:00</span> before trying again.
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" id="cancelAdminBtn" class="btn-secondary">Cancel</button>
                    <button type="submit">Login</button>
                </div>
            </form>
        </div>
    </div>

    <div id="timeoutWarning" class="timeout-warning">
        <h3>‚ö†Ô∏è Session Expiring Soon</h3>
        <p>Your admin session will expire in <span id="timeoutCountdown">5:00</span> due to inactivity.</p>
        <div class="timeout-actions">
            <button id="extendSession" class="btn-secondary">Extend Session</button>
            <button id="logoutNow" class="btn-danger">Logout Now</button>
        </div>
    </div>

    <div id="editPostModal" class="modal">
        <div class="modal-content">
            <button class="close" id="closeEditModal">&times;</button>
            <h2>Edit Post</h2>
            <form id="editPostForm">
                <div class="form-group">
                    <label for="editPostTitle">Title</label>
                    <input type="text" id="editPostTitle" required placeholder="Enter post title...">
                </div>
                <!-- Primary Dropdown: Select which tab/category the post belongs to -->
                <div class="form-group">
                    <label for="editPostCategory">Post Category</label>
                    <select id="editPostCategory">
                        <option value="">Select a category...</option>
                        <option value="history">History</option>
                        <option value="philosophy">Philosophy</option>
                        <option value="literature">Literature</option>
                        <option value="science">Science</option>
                        <option value="technology">Technology</option>
                        <option value="religion">Religion</option>
                    </select>
                </div>

                <!-- Secondary Dropdown: Year range selection (only shown when History is selected) -->
                <div class="form-group" id="editCenturyDropdownContainer" style="display: none;">
                    <label for="editPostCentury">Time Period</label>
                    <select id="editPostCentury">
                        <option value="">Select a time period...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="editPostContent">Content</label>
                    <textarea id="editPostContent" required placeholder="Write your post content here..."></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" id="cancelEditBtn" class="btn-secondary">Cancel</button>
                    <button type="submit">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <div id="confirmationDialog" class="confirmation-dialog">
        <h3 id="confirmTitle">Confirm Action</h3>
        <p id="confirmMessage">Are you sure you want to proceed?</p>
        <div class="confirmation-actions">
            <button id="confirmCancel" class="btn-secondary">Cancel</button>
            <button id="confirmProceed" class="btn-danger">Proceed</button>
        </div>
    </div>

    <div id="postViewModal" class="modal">
        <div class="modal-content post-view-modal-content">
            <button class="close" id="closePostViewModal">&times;</button>
            <div class="post-view-container">
                <div class="post-view-header">
                    <h2 id="postViewTitle" class="post-view-title"></h2>
                    <div id="postViewMeta" class="post-view-meta"></div>
                </div>
                <div id="postViewContent" class="post-view-content"></div>
            </div>
        </div>
    </div>

    <script>
        class BlogApp {
            constructor() {
                this.posts = [];
                this.editingDraftId = null;
                this.drafts = [];

                // Supabase Configuration
                this.supabaseUrl = 'https://cehdeiggnmsaccdazvgm.supabase.co';
                this.supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNlaGRlaWdnbm1zYWNjZGF6dmdtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4OTQyMjgsImV4cCI6MjA3NDQ3MDIyOH0.noHwLw-MZEWfp6gBisXwzEIRfmoV6cNb2uyy2Zv6pBE';
                this.supabase = null;

                // Security Configuration
                this.securityConfig = {
                    enableIPRestriction: false, // IP restrictions disabled for cross-device access
                    maxLoginAttempts: 3,
                    lockoutDuration: 15 * 60 * 1000, // 15 minutes
                    sessionTokens: new Set(),
                    enableActivityLogging: true
                };

                // Obfuscated password and fake security layers
                this.adminPassword = this.createSecureHash('Pacers33!!!');
                this.fakePassword1 = this.createSecureHash('admin123'); // Dummy
                this.fakePassword2 = this.createSecureHash('password'); // Dummy
                this.securitySalt = this.generateSecuritySalt();

                this.sessionTimeout = 2 * 60 * 60 * 1000; // 2 hours
                this.warningTime = 5 * 60 * 1000; // 5 minutes
                this.sessionTimer = null;
                this.warningTimer = null;
                this.countdownInterval = null;
                this.lastActivity = Date.now();
                this.adminLoginTime = null;
                this.sessionDurationInterval = null;
                this.currentEditingPost = null;
                this.pendingConfirmAction = null;
                this.sessionToken = null;
                this.lockoutTimer = null;

                this.initSecuritySystems();
                this.initEventListeners();
                this.checkExistingSession();
                this.initActivityTracking();
                this.initSecurityFeatures();
                this.populateCenturyDropdowns();
                this.initDiscourseSubtabs();
                // FIX: Removed unconditional setUserMode() call that was overriding admin authentication
                // checkExistingSession() already calls updateAdminUI() which sets correct mode
                // This was causing admin panel to disappear on page reload despite valid auth

                // Initialize Supabase connection
                this.initSupabase();

                // Load posts
                this.initializePosts();
            }

            initSupabase() {
                try {
                    const { createClient } = supabase;
                    this.supabase = createClient(this.supabaseUrl, this.supabaseKey);
                    console.log('‚úÖ Supabase client initialized successfully');
                } catch (error) {
                    console.error('‚ùå Error initializing Supabase:', error);
                    this.showErrorMessage('Database connection failed. Using offline mode.');
                }
            }

            async initializePosts() {
                try {
                    this.posts = await this.loadPosts();
                    await this.migratePostData();
                    this.renderPosts();
                    this.populateHistorySubtab();
                    this.updateAdminStats();

                    // FIX: Re-verify admin UI state after async post loading completes
                    // This ensures admin panel stays visible even if there were timing issues
                    if (this.isAdminLoggedIn()) {
                        this.updateAdminUI();
                    }
                } catch (error) {
                    console.error('Error loading posts from database:', error);
                    this.showErrorMessage('Failed to load posts. Using offline mode.');
                    // Fallback to localStorage for offline support
                    this.posts = this.loadPostsFromLocalStorage();
                    this.renderPosts();
                    this.populateHistorySubtab();
                    this.updateAdminStats();

                    // FIX: Re-verify admin UI state after fallback loading
                    if (this.isAdminLoggedIn()) {
                        this.updateAdminUI();
                    }
                }
            }

            // Enhanced Security Methods
            initSecuritySystems() {
                this.initRateLimiting();
                this.fakeSecurityCheck1(); // Dummy security check
            }

            // IP restrictions removed for cross-device compatibility

            createSecureHash(input) {
                // Multi-layer obfuscation
                const layer1 = btoa(input.split('').reverse().join(''));
                const layer2 = this.customHash(layer1 + this.securitySalt);
                const layer3 = btoa(layer2).replace(/[+=]/g, '');
                return layer3;
            }

            customHash(str) {
                let hash = 0;
                const multiplier = 31;
                for (let i = 0; i < str.length; i++) {
                    hash = ((hash * multiplier) + str.charCodeAt(i)) & 0x7fffffff;
                }
                return hash.toString(36);
            }

            generateSecuritySalt() {
                return btoa('securesalt').slice(0, 16); // Fixed salt instead of dynamic
            }

            // Device fingerprinting removed for cross-device compatibility

            fakeSecurityCheck1() {
                // Dummy security check to confuse inspection
                const fakeToken = btoa('fake_security_token_' + Math.random());
                localStorage.setItem('system_token', fakeToken);
                return true;
            }

            fakeSecurityCheck2() {
                // Another dummy check
                return localStorage.getItem('system_token') !== null;
            }

            async migratePostData() {
                let needsSave = false;
                this.posts.forEach(post => {
                    // Map database fields to JavaScript object properties for consistency
                    // Map created_at to timestamp
                    if (!post.timestamp && post.created_at) {
                        post.timestamp = post.created_at;
                        needsSave = true;
                    }

                    // Map word_count to wordCount
                    if (!post.wordCount && post.word_count) {
                        post.wordCount = post.word_count;
                        needsSave = true;
                    }

                    if (!post.lastModified) {
                        post.lastModified = post.timestamp || post.created_at || new Date().toISOString();
                        needsSave = true;
                    }
                    if (!post.wordCount) {
                        post.wordCount = this.countWords(post.content || '');
                        needsSave = true;
                    }
                    if (post.century === undefined) {
                        post.century = null;
                        needsSave = true;
                    }
                    // Ensure all posts have a proper dateString generated from timestamp
                    const dateSource = post.timestamp || post.created_at;
                    if (!post.dateString && dateSource) {
                        post.dateString = this.formatDate(new Date(dateSource));
                        needsSave = true;
                    }
                    // Fix any invalid dateString that might exist
                    if (post.dateString && post.dateString.includes('Invalid')) {
                        post.dateString = this.formatDate(new Date(dateSource));
                        needsSave = true;
                    }
                });
                if (needsSave) {
                    await this.savePosts();
                }
            }

            countWords(text) {
                return text.trim().split(/\s+/).filter(word => word.length > 0).length;
            }

            populateCenturyDropdowns() {
                const centuryOptions = this.generateCenturyOptions();
                const dropdowns = [
                    document.getElementById('postCentury'),
                    document.getElementById('editPostCentury')
                ];

                dropdowns.forEach(dropdown => {
                    if (dropdown) {
                        // Keep the default "Select a time period" option
                        const defaultOption = dropdown.querySelector('option[value=""]');
                        dropdown.innerHTML = '';
                        dropdown.appendChild(defaultOption);

                        // Add all time period options
                        centuryOptions.forEach(century => {
                            const option = document.createElement('option');
                            option.value = century.value;
                            option.textContent = century.display;
                            dropdown.appendChild(option);
                        });
                    }
                });
            }

            generateTimePeriods() {
                return [
                    {
                        value: '1776-present',
                        display: '1776 ‚Äì Present'
                    },
                    {
                        value: '1000-1776ce',
                        display: '1000 ‚Äì 1776 CE'
                    },
                    {
                        value: '0-1000ce',
                        display: '0 ‚Äì 1000 CE'
                    },
                    {
                        value: '5000-0bce',
                        display: '5000 ‚Äì 0 BCE'
                    },
                    {
                        value: '50000-5000bce',
                        display: '50,000 ‚Äì 5000 BCE'
                    },
                    {
                        value: '50000+bce',
                        display: '50,000+ BCE'
                    }
                ];
            }

            generateDiscourseCategories() {
                return [
                    {
                        value: 'history',
                        display: 'History'
                    },
                    {
                        value: 'philosophy',
                        display: 'Philosophy'
                    },
                    {
                        value: 'literature',
                        display: 'Literature'
                    },
                    {
                        value: 'science',
                        display: 'Science'
                    },
                    {
                        value: 'technology',
                        display: 'Technology'
                    },
                    {
                        value: 'religion',
                        display: 'Religion'
                    }
                ];
            }

            generateCenturyOptions() {
                // Only return historical time periods for the dropdown
                // Discourse categories are used elsewhere in the app
                const timePeriods = this.generateTimePeriods();
                return timePeriods;
            }

            populateHistorySubtab() {
                try {
                    const timelineAccordion = document.getElementById('timelineAccordion');
                    if (!timelineAccordion) {
                        console.warn('History timeline accordion element not found');
                        return;
                    }

                    const timePeriods = this.generateTimePeriods();

                    timelineAccordion.innerHTML = timePeriods.map(period => {
                        const periodPosts = this.getPostsByTimePeriod(period.value);
                        const hasPosts = periodPosts.length > 0;

                        return `
                            <div class="century-section" data-century="${period.value}">
                                <div class="century-header" onclick="app.toggleCenturySection('${period.value}')">
                                    <h4 class="century-title">${period.display}</h4>
                                    <span class="century-arrow">‚ñº</span>
                                </div>
                                <div class="century-content">
                                    <div class="century-inner">
                                        ${hasPosts ? this.renderTimelinePosts(periodPosts) : '<div class="century-empty">No articles yet</div>'}
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('');
                } catch (error) {
                    console.error('Error populating history subtab:', error);
                }
            }

            getPostsByTimePeriod(timePeriodValue) {
                return this.posts
                    .filter(post => post.century === timePeriodValue)
                    .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            }

            getPostsByCategory(category) {
                return this.posts
                    .filter(post => post.century === category)
                    .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            }

            populateDiscourseSubtab(subtabName) {
                try {
                    const subtabContainer = document.getElementById(`${subtabName}Subtab`);
                    if (!subtabContainer) {
                        console.warn(`Subtab container for ${subtabName} not found`);
                        return;
                    }

                    // Get posts for this category
                    const categoryPosts = this.getPostsByCategory(subtabName);

                    if (categoryPosts.length === 0) {
                        // Show placeholder if no posts
                        subtabContainer.innerHTML = `
                            <div class="subtab-placeholder">
                                <h4>${subtabName.charAt(0).toUpperCase() + subtabName.slice(1)}</h4>
                                <p>No posts in this category yet. ${this.isAdminLoggedIn() ? 'Create a post and categorize it as "' + subtabName.charAt(0).toUpperCase() + subtabName.slice(1) + '" to see it here.' : 'Check back later for posts in this category.'}</p>
                            </div>
                        `;
                    } else {
                        // Show posts
                        subtabContainer.innerHTML = `
                            <div class="discourse-posts">
                                <h4>${subtabName.charAt(0).toUpperCase() + subtabName.slice(1)} Posts</h4>
                                ${this.renderDiscoursePostList(categoryPosts)}
                            </div>
                        `;
                    }
                } catch (error) {
                    console.error(`Error populating ${subtabName} subtab:`, error);
                }
            }

            renderDiscoursePostList(posts) {
                return posts.map(post => `
                    <div class="discourse-post-item">
                        <div class="discourse-post-title" onclick="app.viewDiscoursePost(${post.id})">${this.escapeHtml(post.title)}</div>
                        <div class="discourse-post-meta">
                            <div class="discourse-post-date">
                                <span>üìÖ</span>
                                <span>${new Date(post.timestamp).toLocaleDateString()}</span>
                            </div>
                            <div class="discourse-post-words">
                                <span>üìù</span>
                                <span>${post.wordCount || 0} words</span>
                            </div>
                        </div>
                        ${this.isAdminLoggedIn() ? `
                            <div class="discourse-post-actions">
                                <button class="timeline-action-btn edit" onclick="event.stopPropagation(); app.openEditModal(${post.id})">Edit</button>
                                <button class="timeline-action-btn delete" onclick="event.stopPropagation(); app.confirmDeletePost(${post.id})">Delete</button>
                            </div>
                        ` : ''}
                    </div>
                `).join('');
            }

            renderTimelinePosts(posts) {
                return `
                    <div class="century-posts">
                        ${posts.map(post => `
                            <div class="timeline-post-item">
                                <div class="timeline-post-title" onclick="app.viewDiscoursePost(${post.id})">${this.escapeHtml(post.title)}</div>
                                <div class="timeline-post-meta">
                                    <div class="timeline-post-date">
                                        <span>üìÖ</span>
                                        <span>${new Date(post.timestamp).toLocaleDateString()}</span>
                                    </div>
                                    <div class="timeline-post-words">
                                        <span>üìù</span>
                                        <span>${post.wordCount || 0} words</span>
                                    </div>
                                </div>
                                ${this.isAdminLoggedIn() ? `
                                    <div class="timeline-post-actions">
                                        <button class="timeline-action-btn edit" onclick="event.stopPropagation(); app.openEditModal(${post.id})">Edit</button>
                                        <button class="timeline-action-btn delete" onclick="event.stopPropagation(); app.confirmDeletePost(${post.id})">Delete</button>
                                    </div>
                                ` : ''}
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            toggleCenturySection(centuryValue) {
                try {
                    const section = document.querySelector(`[data-century="${centuryValue}"]`);
                    if (!section) return;

                    const header = section.querySelector('.century-header');
                    const content = section.querySelector('.century-content');
                    const isExpanded = header.classList.contains('active');

                    // Close all other sections
                    document.querySelectorAll('.century-header.active').forEach(activeHeader => {
                        if (activeHeader !== header) {
                            activeHeader.classList.remove('active');
                            const activeContent = activeHeader.parentElement.querySelector('.century-content');
                            const activeInner = activeContent.querySelector('.century-inner');

                            activeContent.classList.remove('expanded');
                            activeContent.style.maxHeight = '0px';

                            // Reset inner styling for other sections
                            if (activeInner) {
                                activeInner.style.transition = '';
                                activeInner.style.opacity = '';
                                activeInner.style.transform = '';
                            }
                        }
                    });

                    if (isExpanded) {
                        // Collapse this section
                        header.classList.remove('active');
                        content.classList.remove('expanded');
                        content.style.maxHeight = '0px';

                        // Reset inner styling
                        const inner = content.querySelector('.century-inner');
                        if (inner) {
                            inner.style.transition = '';
                            inner.style.opacity = '';
                            inner.style.transform = '';
                        }
                    } else {
                        // Expand this section
                        header.classList.add('active');
                        content.classList.add('expanded');

                        // Calculate and set the actual height for smooth animation
                        const inner = content.querySelector('.century-inner');
                        if (inner) {
                            const height = inner.scrollHeight + 20; // Add extra padding for smooth animation
                            content.style.maxHeight = height + 'px';

                            // Add a subtle fade-in effect for the content
                            inner.style.opacity = '0';
                            inner.style.transform = 'translateY(-10px)';

                            setTimeout(() => {
                                inner.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
                                inner.style.opacity = '1';
                                inner.style.transform = 'translateY(0)';
                            }, 100);
                        }
                    }

                    // Update activity if admin is logged in
                    if (this.isAdminLoggedIn()) {
                        this.lastActivity = Date.now();
                    }
                } catch (error) {
                    console.error('Error toggling century section:', error);
                }
            }

            viewDiscoursePost(postId) {
                try {
                    const post = this.posts.find(p => p.id === postId);
                    if (!post) {
                        this.showErrorMessage('Post not found.');
                        return;
                    }

                    // Populate the modal with post data
                    const titleElement = document.getElementById('postViewTitle');
                    const contentElement = document.getElementById('postViewContent');
                    const metaElement = document.getElementById('postViewMeta');

                    if (!titleElement || !contentElement || !metaElement) {
                        console.error('Modal elements not found');
                        return;
                    }

                    titleElement.textContent = post.title;
                    contentElement.textContent = post.content;

                    // Create meta information
                    const metaHtml = `
                        <div class="post-view-meta-item">
                            <span>üìÖ</span>
                            <span>Posted on ${post.dateString}</span>
                        </div>
                        <div class="post-view-meta-item">
                            <span>üìù</span>
                            <span>${post.wordCount || 0} words</span>
                        </div>
                        ${post.century ? `
                            <div class="post-view-meta-item">
                                <span class="post-view-century">${this.getTimePeriodDisplayName(post.century)}</span>
                            </div>
                        ` : ''}
                        ${post.lastModified !== post.timestamp ? `
                            <div class="post-view-meta-item">
                                <span>‚úèÔ∏è</span>
                                <span>Edited ${new Date(post.lastModified).toLocaleDateString()}</span>
                            </div>
                        ` : ''}
                    `;

                    metaElement.innerHTML = metaHtml;

                    // Show the modal
                    const modal = document.getElementById('postViewModal');
                    if (modal) {
                        modal.style.display = 'block';
                        document.body.style.overflow = 'hidden';
                    }

                    // Update activity if admin is logged in
                    if (this.isAdminLoggedIn()) {
                        this.lastActivity = Date.now();
                    }
                } catch (error) {
                    console.error('Error viewing timeline post:', error);
                    this.showErrorMessage('Error opening post. Please try again.');
                }
            }

            getTimePeriodDisplayName(timePeriodValue) {
                // First check time periods
                const timePeriods = this.generateTimePeriods();
                const timePeriod = timePeriods.find(p => p.value === timePeriodValue);
                if (timePeriod) return timePeriod.display;

                // Then check discourse categories for existing posts
                const discourseCategories = this.generateDiscourseCategories();
                const discourseCategory = discourseCategories.find(p => p.value === timePeriodValue);
                if (discourseCategory) return discourseCategory.display;

                // Fallback to the original value
                return timePeriodValue;
            }

            // Rate Limiting System
            initRateLimiting() {
                const attempts = localStorage.getItem('adminLoginAttempts');
                const lockoutEnd = localStorage.getItem('adminLockoutEnd');

                if (lockoutEnd && Date.now() < parseInt(lockoutEnd)) {
                    this.startLockoutTimer(parseInt(lockoutEnd));
                } else {
                    localStorage.removeItem('adminLockoutEnd');
                    localStorage.setItem('adminLoginAttempts', '0');
                }
            }

            recordLoginAttempt(success = false) {
                const attempts = parseInt(localStorage.getItem('adminLoginAttempts') || '0');
                const newAttempts = success ? 0 : attempts + 1;

                localStorage.setItem('adminLoginAttempts', newAttempts.toString());

                if (!success) {
                    this.logSecurityEvent('LOGIN_FAILED', `Failed attempt ${newAttempts}/3`);

                    if (newAttempts >= this.securityConfig.maxLoginAttempts) {
                        const lockoutEnd = Date.now() + this.securityConfig.lockoutDuration;
                        localStorage.setItem('adminLockoutEnd', lockoutEnd.toString());
                        this.startLockoutTimer(lockoutEnd);
                        this.logSecurityEvent('ACCOUNT_LOCKED', `Locked for 15 minutes`);
                        return false;
                    }
                }
                return true;
            }

            startLockoutTimer(lockoutEnd) {
                const warningDiv = document.getElementById('rateLimitWarning');
                const timerSpan = document.getElementById('lockoutTimer');
                const loginForm = document.getElementById('adminLoginForm');

                warningDiv.classList.add('active');
                loginForm.style.pointerEvents = 'none';
                loginForm.style.opacity = '0.5';

                this.lockoutTimer = setInterval(() => {
                    const remaining = lockoutEnd - Date.now();

                    if (remaining <= 0) {
                        clearInterval(this.lockoutTimer);
                        warningDiv.classList.remove('active');
                        loginForm.style.pointerEvents = 'auto';
                        loginForm.style.opacity = '1';
                        localStorage.removeItem('adminLockoutEnd');
                        localStorage.setItem('adminLoginAttempts', '0');
                        this.logSecurityEvent('LOCKOUT_EXPIRED', 'Account unlocked');
                        return;
                    }

                    const minutes = Math.floor(remaining / 60000);
                    const seconds = Math.floor((remaining % 60000) / 1000);
                    timerSpan.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                }, 1000);
            }

            isRateLimited() {
                const lockoutEnd = localStorage.getItem('adminLockoutEnd');
                return lockoutEnd && Date.now() < parseInt(lockoutEnd);
            }

            // Session Security System
            generateSessionToken() {
                const token = btoa(
                    Date.now() +
                    Math.random() +
                    navigator.userAgent
                ).replace(/[+=]/g, '');

                this.sessionToken = token;
                this.securityConfig.sessionTokens.add(token);
                sessionStorage.setItem('adminSessionToken', token);
                return token;
            }

            validateSessionToken() {
                const token = sessionStorage.getItem('adminSessionToken');
                if (!token || !this.securityConfig.sessionTokens.has(token)) {
                    this.triggerSecurityViolation('INVALID_SESSION_TOKEN');
                    return false;
                }
                return true;
            }

            triggerSecurityViolation(reason) {
                this.logSecurityEvent('SECURITY_VIOLATION', reason);
                this.emergencyLogout();
                this.showErrorMessage('Security violation detected. Session terminated.');
            }

            emergencyLogout() {
                // Clear all admin data
                sessionStorage.clear();
                localStorage.removeItem('adminPersistent');
                this.securityConfig.sessionTokens.clear();
                this.sessionToken = null;
                this.currentEditingPost = null;
                this.clearTimers();
                this.updateAdminUI();
            }

            hashPassword(password) {
                let hash = 0;
                const salt = 'myblogsalt2024';
                const combined = password + salt;
                for (let i = 0; i < combined.length; i++) {
                    const char = combined.charCodeAt(i);
                    hash = ((hash << 5) - hash) + char;
                    hash = hash & hash;
                }
                return hash.toString(36);
            }

            isAdminLoggedIn() {
                const sessionAuth = sessionStorage.getItem('adminLoggedIn') === 'true';
                const persistAuth = localStorage.getItem('adminPersistent') === 'true';
                return sessionAuth || persistAuth;
            }

            checkExistingSession() {
                // FIX: Enhanced session checking with explicit state logging
                const hasPersistentAuth = localStorage.getItem('adminPersistent') === 'true';
                const hasSessionAuth = sessionStorage.getItem('adminLoggedIn') === 'true';

                // Clear session auth if no persistent auth exists
                if (!hasPersistentAuth) {
                    sessionStorage.removeItem('adminLoggedIn');
                }

                // Update UI based on current auth state
                this.updateAdminUI();

                // Start session timer if authenticated
                if (this.isAdminLoggedIn()) {
                    this.startSessionTimer();
                    console.log('‚úÖ Admin session restored on page load');
                } else {
                    console.log('üë§ No admin session found - user mode active');
                }
            }

            setUserMode() {
                document.getElementById('adminToolbar').classList.remove('active');
                this.updateAdminStats();
            }

            setAdminMode() {
                // FIX: Added logging to track when admin mode is activated
                const toolbar = document.getElementById('adminToolbar');
                toolbar.classList.add('active');
                console.log('üîì Admin toolbar activated - classList:', toolbar.classList.value);

                this.adminLoginTime = Date.now();
                this.startSessionDurationCounter();
                this.updateAdminStats();
            }

            updateAdminUI() {
                const createPostBtn = document.getElementById('createPostBtn');
                const adminStatus = document.getElementById('adminStatus');
                const headerIndicator = document.getElementById('headerAdminIndicator');
                const footerAdminLink = document.getElementById('footerAdminLink');

                // FIX: Added comprehensive logging for debugging admin panel visibility
                const isAuthenticated = this.isAdminLoggedIn();
                console.log('üîÑ updateAdminUI called - Auth status:', isAuthenticated);

                if (isAuthenticated) {
                    console.log('‚úÖ Setting ADMIN mode - Panel should be visible');
                    this.setAdminMode();
                    createPostBtn.style.display = 'block';
                    adminStatus.style.display = 'flex';
                    headerIndicator.classList.add('active');
                    footerAdminLink.style.display = 'none';
                } else {
                    console.log('üë§ Setting USER mode - Panel hidden');
                    this.setUserMode();
                    createPostBtn.style.display = 'none';
                    adminStatus.style.display = 'none';
                    headerIndicator.classList.remove('active');
                    footerAdminLink.style.display = 'inline';
                }

                // Refresh timeline to show/hide admin buttons
                this.populateHistorySubtab();
            }

            updateAdminStats() {
                if (!this.isAdminLoggedIn()) return;

                const totalPosts = this.posts.length;
                document.getElementById('totalPostsCount').textContent = `Posts: ${totalPosts}`;
            }

            calculateStorageUsage() {
                const data = JSON.stringify(this.posts);
                const sizeInBytes = new Blob([data]).size;
                if (sizeInBytes < 1024) return sizeInBytes + 'B';
                if (sizeInBytes < 1024 * 1024) return Math.round(sizeInBytes / 1024) + 'KB';
                return Math.round(sizeInBytes / (1024 * 1024)) + 'MB';
            }

            formatDate(date) {
                return date.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            }

            startSessionDurationCounter() {
                if (this.sessionDurationInterval) {
                    clearInterval(this.sessionDurationInterval);
                }

                this.sessionDurationInterval = setInterval(() => {
                    if (this.adminLoginTime) {
                        const duration = Date.now() - this.adminLoginTime;
                        const minutes = Math.floor(duration / 60000);
                        const seconds = Math.floor((duration % 60000) / 1000);
                        document.getElementById('adminSince').textContent =
                            `Session: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    }
                }, 1000);
            }

            initActivityTracking() {
                const events = ['mousedown', 'mousemove', 'keypress', 'scroll', 'touchstart', 'click'];
                events.forEach(event => {
                    document.addEventListener(event, () => {
                        if (this.isAdminLoggedIn()) {
                            this.lastActivity = Date.now();
                            this.resetSessionTimer();
                        }
                    }, true);
                });
            }

            initSecurityFeatures() {
                const adminModal = document.getElementById('adminLoginModal');
                adminModal.addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    return false;
                });

                // Disabled aggressive dev tools detection that was causing false logouts
                // setInterval(() => {
                //     if (this.isAdminLoggedIn() && this.isDevToolsOpen()) {
                //         this.showSuccessMessage('Developer tools detected. Logging out for security.');
                //         this.logout();
                //     }
                // }, 1000);
            }

            isDevToolsOpen() {
                const threshold = 160;
                return window.outerHeight - window.innerHeight > threshold ||
                    window.outerWidth - window.innerWidth > threshold;
            }

            startSessionTimer() {
                this.clearTimers();

                this.warningTimer = setTimeout(() => {
                    this.showTimeoutWarning();
                }, this.sessionTimeout - this.warningTime);

                this.sessionTimer = setTimeout(() => {
                    this.logout();
                    this.showSuccessMessage('Session expired due to inactivity.');
                }, this.sessionTimeout);
            }

            resetSessionTimer() {
                if (this.isAdminLoggedIn()) {
                    this.hideTimeoutWarning();
                    this.startSessionTimer();
                }
            }

            clearTimers() {
                if (this.sessionTimer) clearTimeout(this.sessionTimer);
                if (this.warningTimer) clearTimeout(this.warningTimer);
                if (this.countdownInterval) clearInterval(this.countdownInterval);
            }

            showTimeoutWarning() {
                const warning = document.getElementById('timeoutWarning');
                warning.style.display = 'block';

                let timeLeft = this.warningTime / 1000;
                const countdown = document.getElementById('timeoutCountdown');

                this.countdownInterval = setInterval(() => {
                    const minutes = Math.floor(timeLeft / 60);
                    const seconds = timeLeft % 60;
                    countdown.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                    timeLeft--;

                    if (timeLeft < 0) {
                        clearInterval(this.countdownInterval);
                    }
                }, 1000);
            }

            hideTimeoutWarning() {
                const warning = document.getElementById('timeoutWarning');
                warning.style.display = 'none';
                if (this.countdownInterval) {
                    clearInterval(this.countdownInterval);
                }
            }

            initEventListeners() {
                const createPostBtn = document.getElementById('createPostBtn');
                const closeModal = document.getElementById('closeModal');
                const cancelBtn = document.getElementById('cancelBtn');
                const postForm = document.getElementById('postForm');
                const modal = document.getElementById('createPostModal');

                const footerAdminLink = document.getElementById('footerAdminLink');
                const closeAdminModal = document.getElementById('closeAdminModal');
                const cancelAdminBtn = document.getElementById('cancelAdminBtn');
                const adminLoginForm = document.getElementById('adminLoginForm');
                const adminModal = document.getElementById('adminLoginModal');
                const logoutBtn = document.getElementById('logoutBtn');

                // Admin toolbar elements
                const dashboardToggle = document.getElementById('dashboardToggle');
                const adminCreatePostBtn = document.getElementById('adminCreatePostBtn');
                const savedDraftsBtn = document.getElementById('savedDraftsBtn');
                const adminLogoutBtn = document.getElementById('adminLogoutBtn');

                // Draft functionality
                const saveDraftBtn = document.getElementById('saveDraftBtn');


                // Edit modal elements
                const editPostForm = document.getElementById('editPostForm');
                const closeEditModal = document.getElementById('closeEditModal');
                const cancelEditBtn = document.getElementById('cancelEditBtn');
                const editModal = document.getElementById('editPostModal');



                // Confirmation dialog elements
                const confirmCancel = document.getElementById('confirmCancel');
                const confirmProceed = document.getElementById('confirmProceed');

                const extendSessionBtn = document.getElementById('extendSession');
                const logoutNowBtn = document.getElementById('logoutNow');

                // Post view modal elements
                const postViewModal = document.getElementById('postViewModal');
                const closePostViewModal = document.getElementById('closePostViewModal');

                // Tab functionality
                const tabBtns = document.querySelectorAll('.tab-btn');

                // Main functionality
                createPostBtn.addEventListener('click', () => this.openModal());
                closeModal.addEventListener('click', () => this.closeModal());
                cancelBtn.addEventListener('click', () => this.closeModal());
                postForm.addEventListener('submit', (e) => this.handleSubmit(e));

                // Admin login
                footerAdminLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    this.openAdminModal();
                });
                closeAdminModal.addEventListener('click', () => this.closeAdminModal());
                cancelAdminBtn.addEventListener('click', () => this.closeAdminModal());
                adminLoginForm.addEventListener('submit', (e) => this.handleAdminLogin(e));
                logoutBtn.addEventListener('click', () => this.logout());

                // Admin toolbar
                dashboardToggle.addEventListener('click', () => this.toggleDashboard());
                adminCreatePostBtn.addEventListener('click', () => this.openModal());
                savedDraftsBtn.addEventListener('click', () => this.toggleSavedDrafts());
                adminLogoutBtn.addEventListener('click', () => this.logout());

                // Draft functionality
                saveDraftBtn.addEventListener('click', (e) => this.handleSaveDraft(e));

                // Category dropdown conditional rendering for Create Post modal
                const postCategoryDropdown = document.getElementById('postCategory');
                const centuryContainer = document.getElementById('centuryDropdownContainer');
                postCategoryDropdown.addEventListener('change', (e) => {
                    // Show year range dropdown only when "history" is selected
                    if (e.target.value === 'history') {
                        centuryContainer.style.display = 'block';
                    } else {
                        centuryContainer.style.display = 'none';
                        // Clear the century selection when hiding
                        document.getElementById('postCentury').value = '';
                    }
                });

                // Category dropdown conditional rendering for Edit Post modal
                const editPostCategoryDropdown = document.getElementById('editPostCategory');
                const editCenturyContainer = document.getElementById('editCenturyDropdownContainer');
                editPostCategoryDropdown.addEventListener('change', (e) => {
                    // Show year range dropdown only when "history" is selected
                    if (e.target.value === 'history') {
                        editCenturyContainer.style.display = 'block';
                    } else {
                        editCenturyContainer.style.display = 'none';
                        // Clear the century selection when hiding
                        document.getElementById('editPostCentury').value = '';
                    }
                });

                // AUTO-EXPANDING TEXTAREA: Pure UI functionality for better UX
                // This dynamically adjusts textarea height as user types (NO data handling)
                const autoResizeTextarea = (textarea) => {
                    // Reset height to auto to get the correct scrollHeight
                    textarea.style.height = 'auto';
                    // Set height to scrollHeight to fit content, respecting min/max constraints
                    textarea.style.height = textarea.scrollHeight + 'px';
                };

                // Apply auto-resize to Create Post textarea
                const postContentTextarea = document.getElementById('postContent');
                postContentTextarea.addEventListener('input', function () {
                    autoResizeTextarea(this);
                });

                // Apply auto-resize to Edit Post textarea
                const editPostContentTextarea = document.getElementById('editPostContent');
                editPostContentTextarea.addEventListener('input', function () {
                    autoResizeTextarea(this);
                });

                // Edit modal
                editPostForm.addEventListener('submit', (e) => this.handleEditPost(e));
                closeEditModal.addEventListener('click', () => this.closeEditModal());
                cancelEditBtn.addEventListener('click', () => this.closeEditModal());

                // Dashboard


                // Confirmation dialog
                confirmCancel.addEventListener('click', () => this.hideConfirmationDialog());
                confirmProceed.addEventListener('click', () => this.executeConfirmAction());

                // Session management
                extendSessionBtn.addEventListener('click', () => this.extendSession());
                logoutNowBtn.addEventListener('click', () => this.logout());

                // Tab switching
                tabBtns.forEach(btn => {
                    btn.addEventListener('click', () => this.switchTab(btn.dataset.tab));
                });

                // Post view modal
                closePostViewModal.addEventListener('click', () => this.closePostViewModal());
                postViewModal.addEventListener('click', (e) => {
                    if (e.target === postViewModal) {
                        this.closePostViewModal();
                    }
                });

                // Modal handling
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        this.closeModal();
                    }
                });

                adminModal.addEventListener('click', (e) => {
                    if (e.target === adminModal) {
                        this.closeAdminModal();
                    }
                });

                editModal.addEventListener('click', (e) => {
                    if (e.target === editModal) {
                        this.closeEditModal();
                    }
                });

                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        this.closeModal();
                        this.closeAdminModal();
                        this.closeEditModal();
                        this.closePostViewModal();
                        this.hideTimeoutWarning();
                        this.hideConfirmationDialog();
                    }
                });
            }

            extendSession() {
                this.lastActivity = Date.now();
                this.resetSessionTimer();
                this.hideTimeoutWarning();
                this.showSuccessMessage('Session extended successfully!');
            }

            switchTab(tabName) {
                try {
                    // Remove active class from all tab buttons
                    document.querySelectorAll('.tab-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });

                    // Remove active class from all tab panes
                    document.querySelectorAll('.tab-pane').forEach(pane => {
                        pane.classList.remove('active');
                    });

                    // Add active class to clicked tab button
                    const targetBtn = document.querySelector(`[data-tab="${tabName}"]`);
                    if (targetBtn) {
                        targetBtn.classList.add('active');
                    }

                    // Show corresponding tab pane
                    const targetPane = document.getElementById(`${tabName}Tab`);
                    if (targetPane) {
                        targetPane.classList.add('active');

                        // Special handling for timeline/discourses tab
                        if (tabName === 'timeline') {
                            // Initialize discourse subtabs if they haven't been initialized yet
                            const subtabButtons = targetPane.querySelectorAll('.subtab-btn');
                            if (subtabButtons.length > 0) {
                                const activeSubtab = targetPane.querySelector('.subtab-btn.active');
                                if (!activeSubtab) {
                                    // No active subtab, initialize the discourse system
                                    this.initDiscourseSubtabs();
                                }
                            }
                        }
                    }

                    // Update activity if admin is logged in
                    if (this.isAdminLoggedIn()) {
                        this.lastActivity = Date.now();
                    }
                } catch (error) {
                    console.error('Error switching tabs:', error);
                }
            }

            switchSubtab(subtabName) {
                try {
                    // Validate subtab name
                    const validSubtabs = ['history', 'philosophy', 'literature', 'science', 'technology', 'religion'];
                    if (!validSubtabs.includes(subtabName)) {
                        console.warn(`Invalid subtab name: ${subtabName}`);
                        return;
                    }

                    // Remove active class from all subtab buttons
                    const subtabButtons = document.querySelectorAll('.subtab-btn');
                    if (subtabButtons.length === 0) {
                        console.warn('No subtab buttons found');
                        return;
                    }
                    subtabButtons.forEach(btn => {
                        btn.classList.remove('active');
                    });

                    // Remove active class from all subtab panes
                    const subtabPanes = document.querySelectorAll('.subtab-pane');
                    if (subtabPanes.length === 0) {
                        console.warn('No subtab panes found');
                        return;
                    }
                    subtabPanes.forEach(pane => {
                        pane.classList.remove('active');
                    });

                    // Add active class to clicked subtab button
                    const targetBtn = document.querySelector(`[data-subtab="${subtabName}"]`);
                    if (targetBtn) {
                        targetBtn.classList.add('active');
                    } else {
                        console.warn(`Subtab button with data-subtab="${subtabName}" not found`);
                    }

                    // Show corresponding subtab pane
                    const targetPane = document.getElementById(`${subtabName}Subtab`);
                    if (targetPane) {
                        targetPane.classList.add('active');

                        // Special handling for different subtabs
                        if (subtabName === 'history') {
                            // Always refresh timeline to ensure latest posts are shown
                            this.populateHistorySubtab();
                        } else {
                            // For other discourse subtabs, populate with relevant posts
                            this.populateDiscourseSubtab(subtabName);
                        }
                    } else {
                        console.warn(`Subtab pane with id="${subtabName}Subtab" not found`);
                    }

                    // Update activity if admin is logged in
                    if (this.isAdminLoggedIn()) {
                        this.lastActivity = Date.now();
                    }

                    // Log subtab switch for analytics
                    this.logSecurityEvent('SUBTAB_SWITCHED', `Switched to subtab: ${subtabName}`);

                } catch (error) {
                    console.error('Error switching subtabs:', error);
                    this.showErrorMessage('Error switching between discourse sections.');
                }
            }

            initDiscourseSubtabs() {
                try {
                    // Initialize history subtab with timeline data
                    this.populateHistorySubtab();

                    // Set up event listeners for subtab buttons
                    const subtabButtons = document.querySelectorAll('.subtab-btn');
                    if (subtabButtons.length > 0) {
                        subtabButtons.forEach(btn => {
                            // Remove existing listeners to prevent duplicates
                            btn.removeEventListener('click', this.subtabClickHandler);

                            // Create bound handler
                            this.subtabClickHandler = (e) => {
                                e.preventDefault();
                                this.switchSubtab(btn.dataset.subtab);
                            };

                            // Add new listener
                            btn.addEventListener('click', this.subtabClickHandler);
                        });

                        console.log(`Initialized ${subtabButtons.length} discourse subtab buttons`);
                    } else {
                        console.warn('No discourse subtab buttons found for initialization');
                    }

                    // Ensure History subtab is active by default
                    const historyBtn = document.querySelector('[data-subtab="history"]');
                    const historyPane = document.getElementById('historySubtab');

                    if (historyBtn && historyPane) {
                        historyBtn.classList.add('active');
                        historyPane.classList.add('active');
                    }

                } catch (error) {
                    console.error('Error initializing discourse subtabs:', error);
                }
            }

            openModal() {
                const modal = document.getElementById('createPostModal');
                modal.style.display = 'block';
                document.getElementById('postTitle').focus();
                document.body.style.overflow = 'hidden';
            }

            closeModal() {
                const modal = document.getElementById('createPostModal');
                modal.style.display = 'none';
                document.getElementById('postForm').reset();
                // Reset category dropdown and hide century container
                document.getElementById('postCategory').value = '';
                document.getElementById('centuryDropdownContainer').style.display = 'none';
                // AUTO-RESIZE: Reset textarea height to default
                document.getElementById('postContent').style.height = 'auto';
                document.body.style.overflow = 'auto';
                this.editingDraftId = null;
            }

            openAdminModal() {
                const modal = document.getElementById('adminLoginModal');
                modal.style.display = 'block';
                document.getElementById('adminPassword').focus();
                document.body.style.overflow = 'hidden';
                document.getElementById('loginError').style.display = 'none';
            }

            closeAdminModal() {
                const modal = document.getElementById('adminLoginModal');
                modal.style.display = 'none';
                document.getElementById('adminLoginForm').reset();
                document.getElementById('loginError').style.display = 'none';
                document.body.style.overflow = 'auto';
            }

            handleAdminLogin(e) {
                e.preventDefault();

                if (this.isRateLimited()) {
                    this.showErrorMessage('Account is locked due to too many failed attempts.');
                    return;
                }

                const password = document.getElementById('adminPassword').value;
                const errorDiv = document.getElementById('loginError');

                if (password === 'Pacers33!!!') {
                    if (!this.recordLoginAttempt(true)) return;

                    sessionStorage.setItem('adminLoggedIn', 'true');
                    localStorage.setItem('adminPersistent', 'true');

                    this.lastActivity = Date.now();
                    this.startSessionTimer();
                    this.updateAdminUI();
                    this.closeAdminModal();

                    this.showSuccessMessage('Admin logged in successfully!');

                    this.logSecurityEvent('LOGIN_SUCCESS', 'Admin login successful');
                } else {
                    if (!this.recordLoginAttempt(false)) return;

                    errorDiv.style.display = 'block';
                    document.getElementById('adminPassword').value = '';
                    document.getElementById('adminPassword').focus();
                }
            }

            // Activity Logging System
            logSecurityEvent(action, details = '') {
                if (!this.securityConfig.enableActivityLogging) return;

                const logs = this.getActivityLogs();
                const logEntry = {
                    timestamp: new Date().toISOString(),
                    action: action,
                    details: details,
                    ip: 'Cross-device access',
                    userAgent: navigator.userAgent.substring(0, 50) + '...'
                };

                logs.unshift(logEntry);

                // Keep only last 50 entries
                if (logs.length > 50) {
                    logs.splice(50);
                }

                localStorage.setItem('adminActivityLogs', JSON.stringify(logs));
            }

            getActivityLogs() {
                try {
                    const logs = localStorage.getItem('adminActivityLogs');
                    return logs ? JSON.parse(logs) : [];
                } catch (error) {
                    return [];
                }
            }





            // Security indicator removed for cross-device compatibility





            async editPost(postId) {
                const post = this.posts.find(p => p.id === postId);
                if (!post) return;

                const newTitle = prompt('Edit title:', post.title);
                if (newTitle === null) return;

                const newContent = prompt('Edit content:', post.content);
                if (newContent === null) return;

                if (newTitle.trim() && newContent.trim()) {
                    post.title = newTitle.trim();
                    post.content = newContent.trim();
                    await this.savePosts();
                    this.renderPosts();
                    this.updateAdminStats();
                    this.showSuccessMessage('Post updated successfully!');
                }
            }

            async deletePost(postId) {
                if (!confirm('Are you sure you want to delete this post? This action cannot be undone.')) {
                    return;
                }

                this.posts = this.posts.filter(p => p.id !== postId);
                this.savePosts();
                this.renderPosts();
                this.updateAdminStats();
                this.showSuccessMessage('Post deleted successfully!');
            }

            logout() {
                sessionStorage.removeItem('adminLoggedIn');
                localStorage.removeItem('adminPersistent');
                this.clearTimers();
                this.hideTimeoutWarning();
                if (this.sessionDurationInterval) {
                    clearInterval(this.sessionDurationInterval);
                }
                this.adminLoginTime = null;
                this.updateAdminUI();
                this.showSuccessMessage('Successfully logged out!');
            }

            async handleSubmit(e) {
                e.preventDefault();

                if (!this.isAdminLoggedIn()) {
                    this.showErrorMessage('You must be logged in as admin to create posts.');
                    this.closeModal();
                    return;
                }

                const title = document.getElementById('postTitle').value.trim();
                const content = document.getElementById('postContent').value.trim();
                const category = document.getElementById('postCategory').value;
                const yearRange = document.getElementById('postCentury').value;

                // For History posts, use the year range; for other categories, use the category name
                const century = category === 'history' ? yearRange : category;

                if (!title || !content) {
                    this.showErrorMessage('Please fill in both title and content.');
                    return;
                }

                try {
                    // Check if we're editing a draft
                    if (this.editingDraftId) {
                        // Convert draft to published post
                        const now = new Date();
                        const post = {
                            id: this.editingDraftId,
                            title: title,
                            content: content,
                            century: century || null,
                            timestamp: now.toISOString(),
                            lastModified: now.toISOString(),
                            wordCount: this.countWords(content),
                            dateString: this.formatDate(now)
                        };

                        // Add to posts array
                        this.posts.push(post);

                        // Remove from drafts array
                        this.drafts = this.drafts.filter(d => d.id !== this.editingDraftId);

                        this.editingDraftId = null;
                        this.showSuccessMessage('Draft published successfully!');
                        this.closeModal();
                        await this.initializePosts();
                        this.updateAdminStats();
                        return;
                    }

                    const now = new Date().toISOString();
                    const post = {
                        id: Date.now(),
                        title,
                        content,
                        century: century || null,
                        timestamp: now,
                        lastModified: now,
                        wordCount: this.countWords(content),
                        dateString: new Date().toLocaleDateString('en-US', {
                            year: 'numeric',
                            month: 'long',
                            day: 'numeric',
                            hour: '2-digit',
                            minute: '2-digit'
                        })
                    };

                    // Save to database first
                    const dbSaved = await this.savePostToDatabase(post);

                    if (dbSaved) {
                        this.posts.unshift(post);
                        // Save to localStorage as backup
                        localStorage.setItem('blogPosts', JSON.stringify(this.posts));
                        this.showSuccessMessage('Post created successfully!');
                    } else {
                        // Fallback: save locally only
                        this.posts.unshift(post);
                        localStorage.setItem('blogPosts', JSON.stringify(this.posts));
                        this.showErrorMessage('Post saved locally only - database sync failed');
                    }

                    this.renderPosts();
                    this.populateHistorySubtab();
                    this.closeModal();
                    this.updateAdminStats();
                } catch (error) {
                    this.showErrorMessage('Error creating post: ' + error.message);
                }
            }

            showSuccessMessage(message) {
                this.showToast(message, 'var(--accent)');
            }

            showErrorMessage(message) {
                this.showToast(message, '#ef4444');
            }

            showToast(message, backgroundColor) {
                const toast = document.createElement('div');
                toast.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: ${backgroundColor};
                    color: white;
                    padding: 15px 20px;
                    border-radius: 6px;
                    z-index: 2000;
                    font-weight: 500;
                    box-shadow: 0 4px 12px var(--shadow);
                    transform: translateX(100%);
                    transition: transform 0.3s ease;
                    max-width: 350px;
                    word-wrap: break-word;
                `;
                toast.textContent = message;
                document.body.appendChild(toast);

                setTimeout(() => {
                    toast.style.transform = 'translateX(0)';
                }, 100);

                setTimeout(() => {
                    toast.style.transform = 'translateX(100%)';
                    setTimeout(() => {
                        if (document.body.contains(toast)) {
                            document.body.removeChild(toast);
                        }
                    }, 300);
                }, 4000);
            }

            renderPosts() {
                const container = document.getElementById('postsContainer');

                if (this.posts.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <h3>No posts yet</h3>
                            <p>Click "Create Post" to write your first blog post!</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = this.posts.map(post => {
                    const createdDate = new Date(post.timestamp).toLocaleDateString();
                    const modifiedDate = new Date(post.lastModified).toLocaleDateString();
                    const isModified = post.lastModified !== post.timestamp;

                    return `
                        <article class="post" data-post-id="${post.id}">
                            ${this.isAdminLoggedIn() ? `
                                <div class="post-actions">
                                    <button class="post-action-btn edit" onclick="app.openEditModal(${post.id})">Edit</button>
                                    <button class="post-action-btn delete" onclick="app.confirmDeletePost(${post.id})">Delete</button>
                                </div>
                            ` : ''}
                            <div class="post-header">
                                <h2 class="post-title">${this.escapeHtml(post.title)}</h2>
                                <div class="post-meta">Posted on ${post.dateString}${isModified ? ` (edited ${modifiedDate})` : ''}</div>
                            </div>
                            <div class="post-content">${this.escapeHtml(post.content)}</div>
                            ${this.isAdminLoggedIn() ? `
                                <div class="post-analytics">
                                    <div class="analytics-item">
                                        <span class="analytics-icon">üìù</span>
                                        <span>${post.wordCount || 0} words</span>
                                    </div>
                                    <div class="analytics-item">
                                        <span class="analytics-icon">üìÖ</span>
                                        <span>Created: ${createdDate}</span>
                                    </div>
                                    ${isModified ? `
                                        <div class="analytics-item">
                                            <span class="analytics-icon">‚úèÔ∏è</span>
                                            <span>Modified: ${modifiedDate}</span>
                                        </div>
                                    ` : ''}
                                </div>
                            ` : ''}
                        </article>
                    `;
                }).join('');
            }

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }

            // Edit Post Methods
            openEditModal(postId) {
                if (!this.isAdminLoggedIn()) return;

                const post = this.posts.find(p => p.id === postId);
                if (!post) {
                    this.showErrorMessage('Post not found.');
                    return;
                }

                this.currentEditingPost = post;
                document.getElementById('editPostTitle').value = post.title;
                document.getElementById('editPostContent').value = post.content;

                // Determine if the century value is a category or a year range
                const categories = ['history', 'philosophy', 'literature', 'science', 'technology', 'religion'];
                const centuryValue = post.century || '';

                // Check if the century value is one of the category names
                if (categories.includes(centuryValue)) {
                    // It's a category name (non-history category)
                    document.getElementById('editPostCategory').value = centuryValue;
                    document.getElementById('editPostCentury').value = '';
                    document.getElementById('editCenturyDropdownContainer').style.display = 'none';
                } else if (centuryValue) {
                    // It's a year range (history post)
                    document.getElementById('editPostCategory').value = 'history';
                    document.getElementById('editPostCentury').value = centuryValue;
                    document.getElementById('editCenturyDropdownContainer').style.display = 'block';
                } else {
                    // No category set
                    document.getElementById('editPostCategory').value = '';
                    document.getElementById('editPostCentury').value = '';
                    document.getElementById('editCenturyDropdownContainer').style.display = 'none';
                }

                document.getElementById('editPostModal').style.display = 'block';
                document.getElementById('editPostTitle').focus();
                document.body.style.overflow = 'hidden';

                // AUTO-RESIZE: Adjust textarea height to fit existing content when editing
                setTimeout(() => {
                    const textarea = document.getElementById('editPostContent');
                    textarea.style.height = 'auto';
                    textarea.style.height = textarea.scrollHeight + 'px';
                }, 0);
            }

            closeEditModal() {
                document.getElementById('editPostModal').style.display = 'none';
                document.getElementById('editPostForm').reset();
                // Reset category dropdown and hide century container
                document.getElementById('editPostCategory').value = '';
                document.getElementById('editCenturyDropdownContainer').style.display = 'none';
                // AUTO-RESIZE: Reset textarea height to default
                document.getElementById('editPostContent').style.height = 'auto';
                document.body.style.overflow = 'auto';
                this.currentEditingPost = null;
            }

            closePostViewModal() {
                try {
                    const modal = document.getElementById('postViewModal');
                    if (modal) {
                        modal.style.display = 'none';
                    }
                    document.body.style.overflow = 'auto';
                } catch (error) {
                    console.error('Error closing post view modal:', error);
                }
            }

            async handleEditPost(e) {
                e.preventDefault();

                if (!this.currentEditingPost) {
                    this.showErrorMessage('No post selected for editing.');
                    return;
                }

                const title = document.getElementById('editPostTitle').value.trim();
                const content = document.getElementById('editPostContent').value.trim();
                const category = document.getElementById('editPostCategory').value;
                const yearRange = document.getElementById('editPostCentury').value;

                // For History posts, use the year range; for other categories, use the category name
                const century = category === 'history' ? yearRange : category;

                if (!title || !content) {
                    this.showErrorMessage('Please fill in both title and content.');
                    return;
                }

                try {
                    // Update post data
                    this.currentEditingPost.title = title;
                    this.currentEditingPost.content = content;
                    this.currentEditingPost.century = century || null;
                    this.currentEditingPost.lastModified = new Date().toISOString();
                    this.currentEditingPost.wordCount = this.countWords(content);

                    // Save to database first
                    const dbSaved = await this.savePostToDatabase(this.currentEditingPost);

                    if (dbSaved) {
                        // Save to localStorage as backup
                        localStorage.setItem('blogPosts', JSON.stringify(this.posts));
                        this.showSuccessMessage('Post updated successfully!');
                    } else {
                        // Fallback: save locally only
                        localStorage.setItem('blogPosts', JSON.stringify(this.posts));
                        this.showErrorMessage('Post updated locally only - database sync failed');
                    }

                    this.renderPosts();
                    this.populateHistorySubtab();
                    this.closeEditModal();
                    this.updateAdminStats();

                    this.logSecurityEvent('POST_EDITED', `Edited: "${title}"`);
                } catch (error) {
                    this.showErrorMessage('Error updating post: ' + error.message);
                }
            }

            // Delete Post Methods
            confirmDeletePost(postId) {
                if (!this.isAdminLoggedIn()) return;

                const post = this.posts.find(p => p.id === postId);
                if (!post) {
                    this.showErrorMessage('Post not found.');
                    return;
                }

                this.showConfirmationDialog(
                    'Delete Post',
                    `Are you sure you want to delete "${post.title}"? This action cannot be undone.`,
                    () => this.deletePost(postId)
                );
            }

            async deletePost(postId) {
                try {
                    const postToDelete = this.posts.find(p => p.id === postId);
                    if (!postToDelete) {
                        this.showErrorMessage('Post not found or already deleted.');
                        return;
                    }

                    // Delete from database first
                    const dbDeleted = await this.deletePostFromDatabase(postId);

                    // Remove from local array
                    this.posts = this.posts.filter(p => p.id !== postId);

                    if (dbDeleted) {
                        // Save to localStorage as backup
                        localStorage.setItem('blogPosts', JSON.stringify(this.posts));
                        this.showSuccessMessage('Post deleted successfully!');
                    } else {
                        // Fallback: save locally only
                        localStorage.setItem('blogPosts', JSON.stringify(this.posts));
                        this.showErrorMessage('Post deleted locally only - database sync failed');
                    }

                    this.renderPosts();
                    this.populateHistorySubtab();
                    this.updateAdminStats();
                } catch (error) {
                    this.showErrorMessage('Error deleting post: ' + error.message);
                }
            }

            // Dashboard Methods
            toggleDashboard() {
                const dashboard = document.getElementById('adminDashboard');
                const isActive = dashboard.classList.contains('active');

                if (isActive) {
                    dashboard.classList.remove('active');
                } else {
                    this.updateDashboardStats();
                    dashboard.classList.add('active');
                }
            }

            updateDashboardStats() {
                if (!this.isAdminLoggedIn()) return;

                const totalPosts = this.posts.length;
                const totalWords = this.posts.reduce((sum, post) => sum + (post.wordCount || 0), 0);
                const avgWords = totalPosts > 0 ? Math.round(totalWords / totalPosts) : 0;
                const dataSize = this.calculateStorageUsage();

                document.getElementById('dashTotalPosts').textContent = totalPosts;
                document.getElementById('dashTotalWords').textContent = totalWords.toLocaleString();
                document.getElementById('dashAvgWords').textContent = avgWords;
                document.getElementById('dashDataSize').textContent = dataSize;

                this.updateCenturyStats();
            }

            updateCenturyStats() {
                if (!this.isAdminLoggedIn()) return;

                const centuryStatsContainer = document.getElementById('centuryStats');
                if (!centuryStatsContainer) return;

                const timePeriods = this.generateCenturyOptions();
                const periodPostCounts = {};

                // Count posts per time period
                timePeriods.forEach(period => {
                    periodPostCounts[period.value] = this.getPostsByTimePeriod(period.value).length;
                });

                // Count posts with no time period assigned
                const postsWithoutPeriod = this.posts.filter(post => !post.century).length;

                centuryStatsContainer.innerHTML = `
                    ${postsWithoutPeriod > 0 ? `
                        <div class="century-stat-item">
                            <div class="century-stat-value">${postsWithoutPeriod}</div>
                            <div class="century-stat-label">No Time Period</div>
                        </div>
                    ` : ''}
                    ${timePeriods.map(period => {
                    const count = periodPostCounts[period.value];
                    return `
                            <div class="century-stat-item ${count === 0 ? 'century-stat-empty' : ''}">
                                <div class="century-stat-value">${count}</div>
                                <div class="century-stat-label">${period.display}</div>
                            </div>
                        `;
                }).join('')}
                `;
            }

            // Draft Methods
            toggleSavedDrafts() {
                const dashboard = document.getElementById('adminDashboard');
                const draftsPanel = document.getElementById('savedDraftsDashboard');

                // Hide regular dashboard if it's visible
                dashboard.classList.remove('active');

                // Toggle drafts panel
                if (draftsPanel.style.display === 'block') {
                    draftsPanel.style.display = 'none';
                } else {
                    draftsPanel.style.display = 'block';
                    this.loadDrafts();
                }
            }

            async handleSaveDraft(e) {
                e.preventDefault();

                if (!this.isAdminLoggedIn()) {
                    this.showErrorMessage('You must be logged in as admin to save drafts.');
                    return;
                }

                const title = document.getElementById('postTitle').value.trim();
                const content = document.getElementById('postContent').value.trim();
                const category = document.getElementById('postCategory').value;
                const yearRange = document.getElementById('postCentury').value;

                // For History posts, use the year range; for other categories, use the category name
                const century = category === 'history' ? yearRange : category;

                if (!title || !content) {
                    this.showErrorMessage('Please fill in both title and content.');
                    return;
                }

                try {
                    if (this.editingDraftId) {
                        // Update existing draft
                        const updatedDraft = {
                            id: this.editingDraftId,
                            title: title,
                            content: content,
                            century: century || null,
                            timestamp: this.drafts.find(d => d.id === this.editingDraftId)?.timestamp || new Date().toISOString(),
                            lastModified: new Date().toISOString(),
                            wordCount: this.countWords(content),
                            dateString: this.formatDate(new Date())
                        };

                        // Update in drafts array
                        const index = this.drafts.findIndex(d => d.id === this.editingDraftId);
                        if (index !== -1) {
                            this.drafts[index] = updatedDraft;
                        }

                        this.editingDraftId = null;
                        this.showSuccessMessage('Draft updated successfully!');
                    } else {
                        // Create new draft
                        const draft = {
                            id: Date.now(),
                            title: title,
                            content: content,
                            century: century || null,
                            timestamp: new Date().toISOString(),
                            lastModified: new Date().toISOString(),
                            wordCount: this.countWords(content),
                            dateString: this.formatDate(new Date()),
                            is_draft: true
                        };

                        // Save to GitHub
                        await this.saveDraftToDatabase(draft);
                        this.showSuccessMessage('Draft saved successfully!');
                    }

                    this.closeModal();

                    // Update drafts view if it's open
                    const draftsPanel = document.getElementById('savedDraftsDashboard');
                    if (draftsPanel.style.display === 'block') {
                        this.loadDrafts();
                    }

                } catch (error) {
                    console.error('Error saving draft:', error);
                    this.showErrorMessage('Error saving draft: ' + error.message);
                }
            }

            async loadDrafts() {
                try {
                    console.log('üì• Loading drafts from Supabase...');

                    const { data, error } = await this.supabase
                        .from('posts')
                        .select('*')
                        .eq('is_draft', true)
                        .order('updated_at', { ascending: false });

                    if (error) throw error;

                    this.drafts = data || [];
                    console.log(`‚úÖ Loaded ${this.drafts.length} drafts from Supabase`);

                    this.displayDrafts(this.drafts);
                } catch (error) {
                    console.error('‚ùå Error loading drafts from Supabase:', error);
                    this.showErrorMessage('Error loading drafts: ' + error.message);
                    this.drafts = [];
                    this.displayDrafts([]);
                }
            }

            displayDrafts(drafts) {
                const grid = document.getElementById('draftsGrid');
                const emptyState = document.getElementById('emptyDraftsState');

                if (drafts.length === 0) {
                    grid.innerHTML = '';
                    emptyState.style.display = 'block';
                    return;
                }

                emptyState.style.display = 'none';
                grid.innerHTML = drafts.map(draft => `
                    <div class="draft-card">
                        <h3 class="draft-title">${this.escapeHtml(draft.title)}</h3>
                        <div class="draft-content">${this.escapeHtml(draft.content)}</div>
                        <div class="draft-meta">
                            <span>Created: ${new Date(draft.created_at).toLocaleDateString()}</span>
                            <span>${draft.word_count || this.countWords(draft.content)} words</span>
                        </div>
                        <div class="draft-actions">
                            <button class="draft-btn edit" onclick="app.editDraft(${draft.id})">Edit</button>
                            <button class="draft-btn publish" onclick="app.publishDraft(${draft.id})">Publish</button>
                            <button class="draft-btn delete" onclick="app.deleteDraft(${draft.id})">Delete</button>
                        </div>
                    </div>
                `).join('');
            }

            async editDraft(draftId) {
                try {
                    // Find draft in local drafts array
                    const data = this.drafts.find(d => d.id === draftId);

                    if (!data) {
                        throw new Error('Draft not found');
                    }

                    // Fill the create post modal with draft data
                    document.getElementById('postTitle').value = data.title;
                    document.getElementById('postContent').value = data.content;

                    // Determine if the century value is a category or a year range
                    const categories = ['history', 'philosophy', 'literature', 'science', 'technology', 'religion'];
                    const centuryValue = data.century || '';

                    // Check if the century value is one of the category names
                    if (categories.includes(centuryValue)) {
                        // It's a category name (non-history category)
                        document.getElementById('postCategory').value = centuryValue;
                        document.getElementById('postCentury').value = '';
                        document.getElementById('centuryDropdownContainer').style.display = 'none';
                    } else if (centuryValue) {
                        // It's a year range (history post)
                        document.getElementById('postCategory').value = 'history';
                        document.getElementById('postCentury').value = centuryValue;
                        document.getElementById('centuryDropdownContainer').style.display = 'block';
                    } else {
                        // No category set
                        document.getElementById('postCategory').value = '';
                        document.getElementById('postCentury').value = '';
                        document.getElementById('centuryDropdownContainer').style.display = 'none';
                    }

                    // Store the draft ID for updating
                    this.editingDraftId = draftId;

                    // Open the modal
                    this.openModal();

                    // AUTO-RESIZE: Adjust textarea height to fit loaded draft content
                    setTimeout(() => {
                        const textarea = document.getElementById('postContent');
                        textarea.style.height = 'auto';
                        textarea.style.height = textarea.scrollHeight + 'px';
                    }, 0);

                } catch (error) {
                    console.error('Error loading draft for editing:', error);
                    this.showErrorMessage('Error loading draft for editing: ' + error.message);
                }
            }

            async publishDraft(draftId) {
                try {
                    // Find the draft
                    const draft = this.drafts.find(d => d.id === draftId);
                    if (!draft) {
                        throw new Error('Draft not found');
                    }

                    const now = new Date();
                    const publishTimestamp = now.toISOString();

                    // Convert draft to post
                    const post = {
                        id: draft.id,
                        title: draft.title,
                        content: draft.content,
                        century: draft.century,
                        timestamp: publishTimestamp,
                        lastModified: publishTimestamp,
                        wordCount: this.countWords(draft.content || ''),
                        dateString: this.formatDate(now)
                    };

                    // Add to posts array
                    this.posts.push(post);

                    // Remove from drafts array
                    this.drafts = this.drafts.filter(d => d.id !== draftId);

                    this.showSuccessMessage('Draft published successfully!');
                    this.loadDrafts();
                    await this.initializePosts();

                } catch (error) {
                    console.error('Error publishing draft:', error);
                    this.showErrorMessage('Error publishing draft: ' + error.message);
                }
            }

            async getDraftWordCount(draftId) {
                try {
                    const draft = this.drafts.find(d => d.id === draftId);
                    if (!draft) throw new Error('Draft not found');
                    return this.countWords(draft.content || '');
                } catch (error) {
                    console.error('Error getting draft word count:', error);
                    return 0;
                }
            }

            async deleteDraft(draftId) {
                if (!confirm('Are you sure you want to delete this draft?')) {
                    return;
                }

                try {
                    console.log('üóëÔ∏è Deleting draft from Supabase:', draftId);

                    const { error } = await this.supabase
                        .from('posts')
                        .delete()
                        .eq('id', draftId)
                        .eq('is_draft', true);

                    if (error) throw error;

                    console.log('‚úÖ Draft deleted from Supabase');
                    this.showSuccessMessage('Draft deleted successfully!');
                    this.loadDrafts();

                } catch (error) {
                    console.error('‚ùå Error deleting draft:', error);
                    this.showErrorMessage('Error deleting draft: ' + error.message);
                }
            }

            async saveDraftToDatabase(draft) {
                try {
                    console.log('üíæ Saving draft to Supabase:', draft.id);

                    const { error } = await this.supabase
                        .from('posts')
                        .upsert({
                            id: draft.id,
                            title: draft.title,
                            content: draft.content,
                            century: draft.century || null,
                            created_at: draft.timestamp,
                            updated_at: draft.lastModified,
                            word_count: draft.wordCount,
                            is_draft: true
                        });

                    if (error) throw error;

                    console.log('‚úÖ Draft saved to Supabase:', draft.id);
                    return true;

                } catch (error) {
                    console.error('‚ùå Error saving draft to Supabase:', error);
                    throw error;
                }
            }

            // Storage Methods
            async loadPosts() {
                try {
                    console.log('üì• Loading posts from Supabase...');

                    // Load from Supabase
                    const { data, error } = await this.supabase
                        .from('posts')
                        .select('*')
                        .eq('is_draft', false)
                        .order('created_at', { ascending: false });

                    if (error) {
                        console.error('Supabase error:', error);
                        throw error;
                    }

                    // Also save to localStorage as backup
                    localStorage.setItem('blogPosts', JSON.stringify(data));

                    console.log(`‚úÖ Loaded ${data.length} posts from Supabase`);
                    return data || [];

                } catch (error) {
                    console.error('‚ùå Error loading from Supabase:', error);
                    console.log('‚ö†Ô∏è Falling back to localStorage');

                    // Fallback to localStorage
                    const stored = localStorage.getItem('blogPosts');
                    return stored ? JSON.parse(stored) : [];
                }
            }

            loadPostsFromLocalStorage() {
                try {
                    const stored = localStorage.getItem('blogPosts');
                    return stored ? JSON.parse(stored) : [];
                } catch (error) {
                    console.error('Error loading posts from localStorage:', error);
                    return [];
                }
            }

            showSaveStatus(message, isError = false) {
                if (isError) {
                    this.showErrorMessage(message);
                } else {
                    // Show a temporary status message
                    const existingStatus = document.getElementById('saveStatus');
                    if (existingStatus) {
                        existingStatus.remove();
                    }

                    const statusDiv = document.createElement('div');
                    statusDiv.id = 'saveStatus';
                    statusDiv.style.cssText = `
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        background: var(--primary);
                        color: white;
                        padding: 12px 20px;
                        border-radius: 8px;
                        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                        z-index: 10000;
                        font-size: 14px;
                        opacity: 0;
                        transition: opacity 0.3s ease;
                    `;
                    statusDiv.textContent = message;
                    document.body.appendChild(statusDiv);

                    // Animate in
                    setTimeout(() => statusDiv.style.opacity = '1', 10);

                    // Remove after delay
                    setTimeout(() => {
                        statusDiv.style.opacity = '0';
                        setTimeout(() => statusDiv.remove(), 300);
                    }, 2000);
                }
            }

            async savePosts() {
                try {
                    console.log('üíæ Saving posts to Supabase...');

                    // Save all posts to Supabase
                    for (const post of this.posts) {
                        const { error } = await this.supabase
                            .from('posts')
                            .upsert({
                                id: post.id,
                                title: post.title,
                                content: post.content,
                                created_at: post.timestamp,
                                updated_at: new Date().toISOString(),
                                is_draft: false,
                                century: post.century || null,
                                word_count: post.wordCount || this.countWords(post.content)
                            });

                        if (error) {
                            console.error('Error saving post:', post.id, error);
                            throw error;
                        }
                    }

                    // Also backup to localStorage
                    localStorage.setItem('blogPosts', JSON.stringify(this.posts));

                    console.log(`‚úÖ Saved ${this.posts.length} posts to Supabase`);

                } catch (error) {
                    console.error('‚ùå Error saving to Supabase:', error);

                    // Fallback: save to localStorage only
                    localStorage.setItem('blogPosts', JSON.stringify(this.posts));
                    console.log('‚ö†Ô∏è Saved to localStorage only (Supabase sync failed)');
                }
            }

            // Individual Post Operations
            async savePostToDatabase(post) {
                try {
                    console.log('üíæ Saving post to Supabase:', post.id);

                    const { data, error } = await this.supabase
                        .from('posts')
                        .upsert({
                            id: post.id,
                            title: post.title,
                            content: post.content,
                            created_at: post.timestamp,
                            updated_at: new Date().toISOString(),
                            is_draft: false,
                            century: post.century || null,
                            word_count: post.wordCount || this.countWords(post.content)
                        })
                        .select();

                    if (error) throw error;

                    console.log('‚úÖ Post saved to Supabase:', post.id);

                    // Update local array
                    const existingIndex = this.posts.findIndex(p => p.id === post.id);
                    if (existingIndex >= 0) {
                        this.posts[existingIndex] = post;
                    } else {
                        this.posts.push(post);
                    }

                    // Backup to localStorage
                    localStorage.setItem('blogPosts', JSON.stringify(this.posts));

                    return true;
                } catch (error) {
                    console.error('‚ùå Error saving post to Supabase:', error);
                    return false;
                }
            }

            async deletePostFromDatabase(postId) {
                try {
                    console.log('üóëÔ∏è Deleting post from Supabase:', postId);

                    const { error } = await this.supabase
                        .from('posts')
                        .delete()
                        .eq('id', postId)
                        .eq('is_draft', false);

                    if (error) throw error;

                    console.log('‚úÖ Post deleted from Supabase:', postId);

                    // Update local array
                    this.posts = this.posts.filter(p => p.id !== postId);

                    // Update localStorage
                    localStorage.setItem('blogPosts', JSON.stringify(this.posts));

                    return true;
                } catch (error) {
                    console.error('‚ùå Error deleting from Supabase:', error);
                    return false;
                }
            }

            // Export/Import Methods
            exportPosts() {
                if (this.posts.length === 0) {
                    this.showErrorMessage('No posts to export!');
                    return;
                }

                try {
                    const exportData = {
                        exportDate: new Date().toISOString(),
                        totalPosts: this.posts.length,
                        version: '2.0',
                        posts: this.posts
                    };

                    const dataStr = JSON.stringify(exportData, null, 2);
                    const dataBlob = new Blob([dataStr], { type: 'application/json' });

                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(dataBlob);
                    link.download = `blog-posts-${new Date().toISOString().split('T')[0]}.json`;
                    link.click();

                    URL.revokeObjectURL(link.href);
                    this.showSuccessMessage('Posts exported successfully!');
                } catch (error) {
                    this.showErrorMessage('Error exporting posts: ' + error.message);
                }
            }









            // Confirmation Dialog Methods
            showConfirmationDialog(title, message, action) {
                document.getElementById('confirmTitle').textContent = title;
                document.getElementById('confirmMessage').textContent = message;
                document.getElementById('confirmationDialog').classList.add('active');
                this.pendingConfirmAction = action;
            }

            hideConfirmationDialog() {
                document.getElementById('confirmationDialog').classList.remove('active');
                this.pendingConfirmAction = null;
            }

            executeConfirmAction() {
                if (this.pendingConfirmAction) {
                    this.pendingConfirmAction();
                    this.hideConfirmationDialog();
                }
            }




            // Duplicate logout function removed to prevent conflicts
        }

        let app;
        document.addEventListener('DOMContentLoaded', () => {
            app = new BlogApp();
        });
    </script>
</body>

</html>