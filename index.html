<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Modern Blog</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #1a1a1a;
            --bg-secondary: #2d2d2d;
            --bg-tertiary: #3a3a3a;
            --text-primary: #e0e0e0;
            --text-secondary: #b0b0b0;
            --text-muted: #808080;
            --accent: #4a90e2;
            --accent-hover: #357abd;
            --border: #404040;
            --shadow: rgba(0, 0, 0, 0.3);

        }

        body {
            transition: background-color 0.5s ease;
        }


        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background-color: var(--bg-primary);
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 40px 0;
            border-bottom: 1px solid var(--border);
            margin-bottom: 40px;
            transition: all 0.5s ease;
            position: relative;
        }


        h1 {
            font-size: 2.5rem;
            font-weight: 300;
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
            font-weight: 300;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 40px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .admin-status {
            display: flex;
            align-items: center;
            gap: 10px;
            background: var(--bg-secondary);
            padding: 8px 16px;
            border-radius: 6px;
            border: 1px solid var(--border);
            margin-bottom: 20px;
            justify-content: center;
        }

        .admin-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4ade80;
        }

        .admin-text {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .error-message {
            color: #ef4444;
            font-size: 0.9rem;
            margin-top: 8px;
            display: none;
        }

        .header-admin-indicator {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--bg-secondary);
            color: var(--text-secondary);
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            border: 1px solid var(--border);
            display: none;
        }

        .header-admin-indicator.active {
            display: block;
        }


        .timeout-warning {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--bg-secondary);
            border: 2px solid #f59e0b;
            border-radius: 12px;
            padding: 20px;
            z-index: 2000;
            min-width: 300px;
            text-align: center;
            box-shadow: 0 20px 40px var(--shadow);
            display: none;
        }

        .timeout-warning h3 {
            color: #f59e0b;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .timeout-warning p {
            color: var(--text-secondary);
            margin-bottom: 15px;
        }

        .timeout-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .no-select {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        /* Admin Toolbar */
        .admin-toolbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(90deg, var(--accent), var(--accent-hover));
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1500;
            box-shadow: 0 2px 20px rgba(124, 58, 237, 0.3);
            transform: translateY(-100%);
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .admin-toolbar.active {
            transform: translateY(0);
        }


        .admin-toolbar-left,
        .admin-toolbar-center,
        .admin-toolbar-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .admin-toolbar .admin-logo {
            color: white;
            font-weight: 600;
            font-size: 1rem;
        }

        .admin-toolbar .admin-stats {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.85rem;
            display: flex;
            gap: 20px;
        }

        .admin-toolbar button {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 6px 12px;
            font-size: 0.85rem;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .admin-toolbar button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-1px);
        }

        /* Footer */
        footer {
            margin-top: 60px;
            padding: 40px 0 20px;
            border-top: 1px solid var(--border);
            text-align: center;
            color: var(--text-muted);
        }

        .footer-admin-link {
            color: var(--text-muted);
            text-decoration: none;
            font-size: 0.85rem;
            opacity: 0.6;
            transition: opacity 0.3s ease;
        }

        .footer-admin-link:hover {
            opacity: 1;
            color: var(--accent);
        }


        /* Post Actions */
        .post-actions {
            position: absolute;
            top: 15px;
            right: 15px;
            display: none;
            gap: 8px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }


        .post {
            position: relative;
        }

        .post-action-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .post-action-btn:hover {
            background: var(--accent-hover);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .post-action-btn.edit {
            background: #10b981;
        }

        .post-action-btn.edit:hover {
            background: #059669;
        }

        .post-action-btn.delete {
            background: #ef4444;
        }

        .post-action-btn.delete:hover {
            background: #dc2626;
        }

        /* Post Analytics */
        .post-analytics {
            display: none;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid var(--border);
            font-size: 0.8rem;
            color: var(--text-muted);
            gap: 15px;
        }


        .analytics-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .analytics-icon {
            font-size: 0.7rem;
        }

        /* Admin Dashboard */
        .admin-dashboard {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            display: none;
            animation: slideDown 0.3s ease;
        }

        .admin-dashboard.active {
            display: block;
        }

        .dashboard-title {
            color: var(--text-primary);
            font-size: 1.3rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: var(--bg-tertiary);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border);
            text-align: center;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--accent);
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .dashboard-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .dashboard-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }

        .dashboard-btn:hover {
            background: var(--accent-hover);
            transform: translateY(-1px);
        }

        .dashboard-btn.export {
            background: #10b981;
        }

        .dashboard-btn.export:hover {
            background: #059669;
        }

        .dashboard-btn.import {
            background: #f59e0b;
        }

        .dashboard-btn.import:hover {
            background: #d97706;
        }

        /* Century Stats Section */
        .century-stats-section {
            margin: 25px 0;
            padding: 20px 0;
            border-top: 1px solid var(--border);
        }

        .century-stats-title {
            color: var(--text-primary);
            font-size: 1.1rem;
            margin-bottom: 15px;
            font-weight: 500;
        }

        .century-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 12px;
        }

        .century-stat-item {
            background: var(--bg-tertiary);
            padding: 12px;
            border-radius: 6px;
            border: 1px solid var(--border);
            text-align: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .century-stat-item:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--shadow);
        }

        .century-stat-value {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--accent);
            margin-bottom: 4px;
        }

        .century-stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .century-stat-empty {
            opacity: 0.6;
        }

        /* Import Section */
        .import-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
            display: none;
        }

        .import-section.active {
            display: block;
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
            margin-right: 15px;
        }

        .file-input {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-input-label {
            background: var(--bg-tertiary);
            border: 2px dashed var(--border);
            padding: 15px 25px;
            border-radius: 6px;
            display: inline-block;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-secondary);
        }

        .file-input-label:hover {
            border-color: var(--accent);
            color: var(--text-primary);
        }

        /* Confirmation Dialog */
        .confirmation-dialog {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--bg-secondary);
            border: 2px solid #ef4444;
            border-radius: 12px;
            padding: 25px;
            z-index: 2000;
            min-width: 350px;
            text-align: center;
            box-shadow: 0 20px 40px var(--shadow);
            display: none;
        }

        .confirmation-dialog.active {
            display: block;
            animation: slideDown 0.3s ease;
        }

        .confirmation-dialog h3 {
            color: #ef4444;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .confirmation-dialog p {
            color: var(--text-secondary);
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .confirmation-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        /* Security Features */
        .rate-limit-warning {
            background: #dc2626;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            text-align: center;
            display: none;
        }

        .rate-limit-warning.active {
            display: block;
            animation: slideDown 0.3s ease;
        }

        .security-indicator {
            position: fixed;
            top: 10px;
            left: 10px;
            background: var(--accent);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.7rem;
            z-index: 1000;
            display: none;
        }

        .security-indicator.active {
            display: block;
        }

        .activity-log {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
        }

        .activity-log h4 {
            color: var(--text-primary);
            margin-bottom: 15px;
            font-size: 1rem;
        }

        .log-entry {
            background: var(--bg-tertiary);
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 4px;
            font-size: 0.85rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .log-action {
            color: var(--text-primary);
            font-weight: 500;
        }

        .log-time {
            color: var(--text-muted);
            font-size: 0.75rem;
        }

        .log-ip {
            color: var(--accent);
            font-family: monospace;
            font-size: 0.75rem;
        }

        .security-status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .security-stat {
            background: var(--bg-tertiary);
            padding: 12px;
            border-radius: 6px;
            text-align: center;
            border: 1px solid var(--border);
        }

        .security-stat.warning {
            border-color: #f59e0b;
            background: rgba(245, 158, 11, 0.1);
        }

        .security-stat.danger {
            border-color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }

        .security-stat-value {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--accent);
            margin-bottom: 4px;
        }

        .security-stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        /* Animations */
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.7;
            }
        }



        /* Enhanced modal animations */
        .modal {
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            animation: slideDown 0.3s ease;
        }

        /* Tab System Styles */
        .tab-container {
            margin-bottom: 30px;
            border-bottom: 1px solid var(--border);
        }

        .tab-nav {
            display: flex;
            justify-content: center;
            gap: 0;
            background: var(--bg-secondary);
            border-radius: 8px 8px 0 0;
            padding: 0;
            margin: 0 auto;
            max-width: 400px;
            overflow: hidden;
            box-shadow: 0 2px 8px var(--shadow);
        }

        .tab-btn {
            background: transparent;
            border: none;
            padding: 15px 30px;
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            position: relative;
            flex: 1;
            min-width: 0;
        }

        .tab-btn:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            transform: none;
        }

        .tab-btn.active {
            background: var(--bg-tertiary);
            color: var(--accent);
            border-bottom-color: var(--accent);
            font-weight: 600;
        }

        .tab-btn.active::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--accent);
        }


        /* Tab Content */
        .tab-content {
            min-height: 400px;
        }

        .tab-pane {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-pane.active {
            display: block;
        }

        .timeline-placeholder {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
            background: var(--bg-secondary);
            border-radius: 12px;
            border: 1px solid var(--border);
            margin-top: 20px;
        }

        .timeline-placeholder h3 {
            font-size: 1.3rem;
            margin-bottom: 10px;
            font-weight: 400;
            color: var(--text-secondary);
        }

        .timeline-placeholder p {
            font-size: 1rem;
            line-height: 1.6;
        }

        /* Timeline Tab Specific Styles */
        .timeline-container {
            max-width: 100%;
        }

        .timeline-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: var(--bg-secondary);
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .timeline-header h3 {
            font-size: 1.4rem;
            margin-bottom: 8px;
            color: var(--text-primary);
            font-weight: 500;
        }

        .timeline-header p {
            color: var(--text-secondary);
            font-size: 1rem;
            margin: 0;
        }

        .timeline-accordion {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .century-section {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .century-section:hover {
            border-color: var(--accent);
            box-shadow: 0 2px 8px var(--shadow);
        }

        .century-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 20px;
            cursor: pointer;
            background: var(--bg-secondary);
            transition: background-color 0.3s ease;
            user-select: none;
        }

        .century-header:hover {
            background: var(--bg-tertiary);
        }

        .century-header.active {
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border);
        }

        .century-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
        }

        .century-arrow {
            font-size: 0.9rem;
            color: var(--text-secondary);
            transition: transform 0.3s ease;
            margin-left: 10px;
        }

        .century-header.active .century-arrow {
            transform: rotate(180deg);
        }

        .century-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            background: var(--bg-tertiary);
        }

        .century-content.expanded {
            max-height: 500px;
            /* Will be adjusted by JavaScript */
        }

        .century-inner {
            padding: 20px;
        }

        .century-empty {
            text-align: center;
            color: var(--text-muted);
            font-style: italic;
            font-size: 0.95rem;
            padding: 15px 0;
        }

        .century-posts {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .timeline-post-item {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 12px 16px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .timeline-post-item:hover {
            background: var(--bg-secondary);
            border-color: var(--accent);
            transform: translateX(4px);
            box-shadow: 0 4px 12px var(--shadow);
        }

        .timeline-post-title {
            color: var(--text-primary);
            text-decoration: none;
            font-size: 1rem;
            font-weight: 500;
            line-height: 1.4;
            margin: 0;
            display: block;
            word-wrap: break-word;
            overflow-wrap: break-word;
            hyphens: auto;
        }

        .timeline-post-title:hover {
            color: var(--accent);
        }

        .timeline-post-meta {
            color: var(--text-muted);
            font-size: 0.85rem;
            margin-top: 4px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .timeline-post-date {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .timeline-post-words {
            display: flex;
            align-items: center;
            gap: 4px;
        }


        .timeline-post-actions {
            display: none;
            margin-top: 8px;
            gap: 8px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }


        .timeline-action-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .timeline-action-btn:hover {
            background: var(--accent-hover);
            transform: translateY(-1px);
        }

        .timeline-action-btn.edit {
            background: #10b981;
        }

        .timeline-action-btn.edit:hover {
            background: #059669;
        }

        .timeline-action-btn.delete {
            background: #ef4444;
        }

        .timeline-action-btn.delete:hover {
            background: #dc2626;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .admin-toolbar {
                flex-direction: column;
                gap: 10px;
                padding: 10px;
            }

            .admin-toolbar-left,
            .admin-toolbar-center,
            .admin-toolbar-right {
                width: 100%;
                justify-content: center;
            }

            .admin-stats {
                flex-direction: column;
                gap: 5px !important;
                text-align: center;
            }


            /* Tab responsiveness */
            .tab-nav {
                max-width: 100%;
                margin: 0 15px;
                border-radius: 6px 6px 0 0;
            }

            .tab-btn {
                padding: 12px 20px;
                font-size: 0.9rem;
                min-width: 80px;
            }

            .tab-container {
                margin-bottom: 20px;
            }

            .timeline-placeholder {
                margin: 10px;
                padding: 40px 15px;
            }

            .timeline-placeholder h3 {
                font-size: 1.1rem;
            }

            .timeline-placeholder p {
                font-size: 0.9rem;
            }

            /* Timeline mobile responsiveness */
            .timeline-header {
                margin-bottom: 20px;
                padding: 15px;
            }

            .timeline-header h3 {
                font-size: 1.2rem;
            }

            .timeline-header p {
                font-size: 0.9rem;
            }

            .century-header {
                padding: 14px 16px;
            }

            .century-title {
                font-size: 1rem;
            }

            .century-inner {
                padding: 15px;
            }

            .century-empty {
                font-size: 0.9rem;
                padding: 12px 0;
            }

            .timeline-post-item {
                padding: 10px 12px;
            }

            .timeline-post-title {
                font-size: 0.95rem;
            }

            .timeline-post-meta {
                font-size: 0.8rem;
                gap: 8px;
                flex-direction: column;
                align-items: flex-start;
            }

            .timeline-action-btn {
                padding: 6px 10px;
                font-size: 0.8rem;
            }


            /* Century stats mobile responsiveness */
            .century-stats-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
                gap: 8px;
            }

            .century-stat-item {
                padding: 8px;
            }

            .century-stat-value {
                font-size: 1.1rem;
            }

            .century-stat-label {
                font-size: 0.75rem;
            }
        }

        button {
            background: var(--accent);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        button:hover {
            background: var(--accent-hover);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: #4a4a4a;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            backdrop-filter: blur(4px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--bg-secondary);
            padding: 30px;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px var(--shadow);
        }

        .modal h2 {
            margin-bottom: 20px;
            color: var(--text-primary);
            font-weight: 400;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        input,
        textarea,
        select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            font-size: 1rem;
            font-family: inherit;
        }

        input:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 200px;
            font-family: inherit;
        }

        .modal-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 30px;
        }

        .posts-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .post {
            background: var(--bg-secondary);
            padding: 30px;
            border-radius: 12px;
            border: 1px solid var(--border);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .post:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px var(--shadow);
        }

        .post-header {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }

        .post-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .post-meta {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .post-content {
            color: var(--text-secondary);
            font-size: 1rem;
            line-height: 1.7;
            white-space: pre-wrap;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
        }

        .empty-state h3 {
            font-size: 1.3rem;
            margin-bottom: 10px;
            font-weight: 400;
        }

        .close {
            position: absolute;
            right: 20px;
            top: 20px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-muted);
            padding: 5px;
            border-radius: 4px;
            transition: color 0.3s ease;
        }

        .close:hover {
            color: var(--text-primary);
            background: var(--bg-tertiary);
        }

        /* Post View Modal Styles */
        .post-view-modal-content {
            max-width: 800px;
            max-height: 90vh;
        }

        .post-view-container {
            padding: 0;
        }

        .post-view-header {
            padding: 20px 30px;
            border-bottom: 1px solid var(--border);
            margin-bottom: 0;
        }

        .post-view-title {
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text-primary);
            line-height: 1.3;
        }

        .post-view-meta {
            color: var(--text-muted);
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .post-view-meta-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .post-view-content {
            padding: 30px;
            color: var(--text-secondary);
            font-size: 1.1rem;
            line-height: 1.7;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .post-view-century {
            background: var(--accent);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 500;
        }


        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            h1 {
                font-size: 2rem;
            }

            .modal-content {
                padding: 20px;
                margin: 20px;
                width: calc(100% - 40px);
            }

            .post {
                padding: 20px;
            }

            .controls {
                flex-direction: column;
                align-items: center;
            }

            button {
                width: 100%;
                max-width: 300px;
            }
        }

        @media (max-width: 480px) {
            .modal-actions {
                flex-direction: column;
            }

            button {
                width: 100%;
            }

            /* Post view modal mobile responsiveness */
            .post-view-modal-content {
                max-width: 95%;
                max-height: 95vh;
                margin: 10px;
            }

            .post-view-header {
                padding: 15px 20px;
            }

            .post-view-title {
                font-size: 1.4rem;
                margin-bottom: 10px;
            }

            .post-view-meta {
                font-size: 0.9rem;
                gap: 15px;
                flex-direction: column;
                align-items: flex-start;
            }

            .post-view-content {
                padding: 20px;
                font-size: 1rem;
                line-height: 1.6;
            }

            .post-view-century {
                font-size: 0.8rem;
                padding: 3px 10px;
            }
        }
    </style>
</head>

<body>
    <div id="securityIndicator" class="security-indicator">🛡️ Secured</div>

    <div class="container">
        <header>
            <div id="headerAdminIndicator" class="header-admin-indicator">🔒 Admin Mode</div>
            <h1>My Modern Blog</h1>
            <p class="subtitle">Share your thoughts with the world</p>
        </header>

        <!-- Tab Navigation -->
        <div class="tab-container">
            <div class="tab-nav">
                <button class="tab-btn active" data-tab="home">Home</button>
                <button class="tab-btn" data-tab="timeline">Timeline</button>
            </div>
        </div>

        <div id="adminStatus" class="admin-status" style="display: none;">
            <div class="admin-indicator"></div>
            <span class="admin-text">Logged in as Admin</span>
            <button id="logoutBtn" class="btn-danger" style="padding: 4px 12px; font-size: 0.8rem;">Logout</button>
        </div>

        <!-- Admin Toolbar -->
        <div id="adminToolbar" class="admin-toolbar">
            <div class="admin-toolbar-left">
                <span class="admin-logo">🔒 Admin Panel</span>
            </div>
            <div class="admin-toolbar-center">
                <div class="admin-stats">
                    <span id="totalPostsCount">Posts: 0</span>
                    <span id="adminSince">Session: 00:00</span>
                </div>
            </div>
            <div class="admin-toolbar-right">
                <button id="dashboardToggle">Dashboard</button>
                <button id="adminCreatePostBtn">Create Post</button>
                <button id="adminLogoutBtn" class="btn-danger">Logout</button>
            </div>
        </div>

        <!-- Admin Dashboard -->
        <div id="adminDashboard" class="admin-dashboard">
            <h2 class="dashboard-title">📊 Admin Dashboard</h2>
            <div class="dashboard-stats">
                <div class="stat-card">
                    <div class="stat-value" id="dashTotalPosts">0</div>
                    <div class="stat-label">Total Posts</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="dashTotalWords">0</div>
                    <div class="stat-label">Total Words</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="dashAvgWords">0</div>
                    <div class="stat-label">Avg Words/Post</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="dashDataSize">0KB</div>
                    <div class="stat-label">Storage Used</div>
                </div>
            </div>

            <div class="century-stats-section">
                <h3 class="century-stats-title">Posts by Century</h3>
                <div id="centuryStats" class="century-stats-grid">
                    <!-- Century stats will be populated by JavaScript -->
                </div>
            </div>

        </div>


        <!-- Tab Content -->
        <div class="tab-content">
            <!-- Home Tab -->
            <div id="homeTab" class="tab-pane active">
                <div class="controls">
                    <button id="createPostBtn" style="display: none;">Create Post</button>
                </div>

                <div id="postsContainer" class="posts-container">
                    <div class="empty-state">
                        <h3>No posts yet</h3>
                        <p>Click "Create Post" to write your first blog post!</p>
                    </div>
                </div>
            </div>

            <!-- Timeline Tab -->
            <div id="timelineTab" class="tab-pane">
                <div class="timeline-container">
                    <div class="timeline-header">
                        <h3>Historical Timeline</h3>
                        <p>Explore posts organized by historical periods</p>
                    </div>
                    <div id="timelineAccordion" class="timeline-accordion">
                        <!-- Accordion sections will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <a href="#" id="footerAdminLink" class="footer-admin-link">Admin</a>
        </footer>
    </div>

    <div id="createPostModal" class="modal">
        <div class="modal-content">
            <button class="close" id="closeModal">&times;</button>
            <h2>Create New Post</h2>
            <form id="postForm">
                <div class="form-group">
                    <label for="postTitle">Title</label>
                    <input type="text" id="postTitle" required placeholder="Enter your post title...">
                </div>
                <div class="form-group">
                    <label for="postCentury">Century (optional)</label>
                    <select id="postCentury">
                        <option value="">Select a century (optional)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="postContent">Content</label>
                    <textarea id="postContent" required placeholder="Write your post content here..."></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" id="cancelBtn" class="btn-secondary">Cancel</button>
                    <button type="submit">Post</button>
                </div>
            </form>
        </div>
    </div>

    <div id="adminLoginModal" class="modal no-select">
        <div class="modal-content">
            <button class="close" id="closeAdminModal">&times;</button>
            <h2>Admin Login</h2>
            <form id="adminLoginForm">
                <div class="form-group">
                    <label for="adminPassword">Password</label>
                    <input type="password" id="adminPassword" required placeholder="Enter admin password...">
                    <div id="loginError" class="error-message">Incorrect password. Please try again.</div>
                    <div id="rateLimitWarning" class="rate-limit-warning">
                        Too many failed attempts. Please wait <span id="lockoutTimer">15:00</span> before trying again.
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" id="cancelAdminBtn" class="btn-secondary">Cancel</button>
                    <button type="submit">Login</button>
                </div>
            </form>
        </div>
    </div>

    <div id="timeoutWarning" class="timeout-warning">
        <h3>⚠️ Session Expiring Soon</h3>
        <p>Your admin session will expire in <span id="timeoutCountdown">5:00</span> due to inactivity.</p>
        <div class="timeout-actions">
            <button id="extendSession" class="btn-secondary">Extend Session</button>
            <button id="logoutNow" class="btn-danger">Logout Now</button>
        </div>
    </div>

    <div id="editPostModal" class="modal">
        <div class="modal-content">
            <button class="close" id="closeEditModal">&times;</button>
            <h2>Edit Post</h2>
            <form id="editPostForm">
                <div class="form-group">
                    <label for="editPostTitle">Title</label>
                    <input type="text" id="editPostTitle" required placeholder="Enter post title...">
                </div>
                <div class="form-group">
                    <label for="editPostCentury">Century (optional)</label>
                    <select id="editPostCentury">
                        <option value="">Select a century (optional)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="editPostContent">Content</label>
                    <textarea id="editPostContent" required placeholder="Write your post content here..."></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" id="cancelEditBtn" class="btn-secondary">Cancel</button>
                    <button type="submit">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <div id="confirmationDialog" class="confirmation-dialog">
        <h3 id="confirmTitle">Confirm Action</h3>
        <p id="confirmMessage">Are you sure you want to proceed?</p>
        <div class="confirmation-actions">
            <button id="confirmCancel" class="btn-secondary">Cancel</button>
            <button id="confirmProceed" class="btn-danger">Proceed</button>
        </div>
    </div>

    <div id="postViewModal" class="modal">
        <div class="modal-content post-view-modal-content">
            <button class="close" id="closePostViewModal">&times;</button>
            <div class="post-view-container">
                <div class="post-view-header">
                    <h2 id="postViewTitle" class="post-view-title"></h2>
                    <div id="postViewMeta" class="post-view-meta"></div>
                </div>
                <div id="postViewContent" class="post-view-content"></div>
            </div>
        </div>
    </div>

    <script>
        class BlogApp {
            constructor() {
                this.posts = this.loadPosts();

                // Security Configuration
                this.securityConfig = {
                    enableIPRestriction: false, // Set to true to enable IP whitelist
                    allowedIPs: ['127.0.0.1', 'localhost'], // Add your IPs here
                    maxLoginAttempts: 3,
                    lockoutDuration: 15 * 60 * 1000, // 15 minutes
                    sessionTokens: new Set(),
                    enableActivityLogging: true
                };

                // Obfuscated password and fake security layers
                this.adminPassword = this.createSecureHash('Pacers33!!!');
                this.fakePassword1 = this.createSecureHash('admin123'); // Dummy
                this.fakePassword2 = this.createSecureHash('password'); // Dummy
                this.securitySalt = this.generateSecuritySalt();

                this.sessionTimeout = 2 * 60 * 60 * 1000; // 2 hours
                this.warningTime = 5 * 60 * 1000; // 5 minutes
                this.sessionTimer = null;
                this.warningTimer = null;
                this.countdownInterval = null;
                this.lastActivity = Date.now();
                this.adminLoginTime = null;
                this.sessionDurationInterval = null;
                this.currentEditingPost = null;
                this.pendingConfirmAction = null;
                this.currentIP = null;
                this.sessionToken = null;
                this.lockoutTimer = null;

                this.initSecuritySystems();
                this.initEventListeners();
                this.migratePostData();
                this.renderPosts();
                this.checkExistingSession();
                this.initActivityTracking();
                this.initSecurityFeatures();
                this.populateCenturyDropdowns();
                this.populateTimelineTab();
                this.setUserMode();
            }

            // Enhanced Security Methods
            initSecuritySystems() {
                this.detectCurrentIP();
                this.checkIPRestrictions();
                this.initRateLimiting();
                this.fakeSecurityCheck1(); // Dummy security check
                this.generateSessionFingerprint();
            }

            detectCurrentIP() {
                // Multiple IP detection methods for redundancy
                fetch('https://api.ipify.org?format=json')
                    .then(response => response.json())
                    .then(data => {
                        this.currentIP = data.ip;
                        this.updateSecurityIndicator();
                    })
                    .catch(() => {
                        // Fallback IP detection
                        this.currentIP = 'Unknown';
                    });
            }

            checkIPRestrictions() {
                if (!this.securityConfig.enableIPRestriction) return true;

                if (this.currentIP && !this.securityConfig.allowedIPs.includes(this.currentIP)) {
                    this.logSecurityEvent('IP_RESTRICTED', `Blocked IP: ${this.currentIP}`);
                    document.getElementById('footerAdminLink').style.display = 'none';
                    return false;
                }
                return true;
            }

            createSecureHash(input) {
                // Multi-layer obfuscation
                const layer1 = btoa(input.split('').reverse().join(''));
                const layer2 = this.customHash(layer1 + this.securitySalt);
                const layer3 = btoa(layer2).replace(/[+=]/g, '');
                return layer3;
            }

            customHash(str) {
                let hash = 0;
                const multiplier = 31;
                for (let i = 0; i < str.length; i++) {
                    hash = ((hash * multiplier) + str.charCodeAt(i)) & 0x7fffffff;
                }
                return hash.toString(36);
            }

            generateSecuritySalt() {
                return btoa('securesalt').slice(0, 16); // Fixed salt instead of dynamic
            }

            generateSessionFingerprint() {
                const fingerprint = btoa(
                    navigator.userAgent +
                    screen.width + screen.height +
                    navigator.language +
                    Date.now()
                ).slice(0, 32);
                return fingerprint;
            }

            fakeSecurityCheck1() {
                // Dummy security check to confuse inspection
                const fakeToken = btoa('fake_security_token_' + Math.random());
                localStorage.setItem('system_token', fakeToken);
                return true;
            }

            fakeSecurityCheck2() {
                // Another dummy check
                return localStorage.getItem('system_token') !== null;
            }

            migratePostData() {
                let needsSave = false;
                this.posts.forEach(post => {
                    if (!post.lastModified) {
                        post.lastModified = post.timestamp || new Date().toISOString();
                        needsSave = true;
                    }
                    if (!post.wordCount) {
                        post.wordCount = this.countWords(post.content || '');
                        needsSave = true;
                    }
                    if (post.century === undefined) {
                        post.century = null;
                        needsSave = true;
                    }
                });
                if (needsSave) {
                    this.savePosts();
                }
            }

            countWords(text) {
                return text.trim().split(/\s+/).filter(word => word.length > 0).length;
            }

            populateCenturyDropdowns() {
                const centuryOptions = this.generateCenturyOptions();
                const dropdowns = [
                    document.getElementById('postCentury'),
                    document.getElementById('editPostCentury')
                ];

                dropdowns.forEach(dropdown => {
                    if (dropdown) {
                        // Keep the default "Select a century" option
                        const defaultOption = dropdown.querySelector('option[value=""]');
                        dropdown.innerHTML = '';
                        dropdown.appendChild(defaultOption);

                        // Add all century options
                        centuryOptions.forEach(century => {
                            const option = document.createElement('option');
                            option.value = century.value;
                            option.textContent = century.display;
                            dropdown.appendChild(option);
                        });
                    }
                });
            }

            generateCenturyOptions() {
                const centuries = [];

                // BC centuries: 10,000 BC down to 1,000 BC
                for (let year = 10000; year >= 1000; year -= 1000) {
                    centuries.push({
                        value: `${year}BC`,
                        display: `${year.toLocaleString()} BC`
                    });
                }

                // AD centuries: 1000s, 2000s
                centuries.push({
                    value: '1000s',
                    display: '1000s'
                });

                centuries.push({
                    value: '2000s',
                    display: '2000s'
                });

                return centuries;
            }

            populateTimelineTab() {
                try {
                    const timelineAccordion = document.getElementById('timelineAccordion');
                    if (!timelineAccordion) {
                        console.warn('Timeline accordion element not found');
                        return;
                    }

                    const centuries = this.generateCenturyOptions();

                    timelineAccordion.innerHTML = centuries.map(century => {
                        const centuryPosts = this.getPostsByCentury(century.value);
                        const hasPosts = centuryPosts.length > 0;

                        return `
                            <div class="century-section" data-century="${century.value}">
                                <div class="century-header" onclick="app.toggleCenturySection('${century.value}')">
                                    <h4 class="century-title">${century.display}</h4>
                                    <span class="century-arrow">▼</span>
                                </div>
                                <div class="century-content">
                                    <div class="century-inner">
                                        ${hasPosts ? this.renderTimelinePosts(centuryPosts) : '<div class="century-empty">No articles yet</div>'}
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('');
                } catch (error) {
                    console.error('Error populating timeline tab:', error);
                }
            }

            getPostsByCentury(centuryValue) {
                return this.posts
                    .filter(post => post.century === centuryValue)
                    .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            }

            renderTimelinePosts(posts) {
                return `
                    <div class="century-posts">
                        ${posts.map(post => `
                            <div class="timeline-post-item">
                                <div class="timeline-post-title" onclick="app.viewTimelinePost(${post.id})">${this.escapeHtml(post.title)}</div>
                                <div class="timeline-post-meta">
                                    <div class="timeline-post-date">
                                        <span>📅</span>
                                        <span>${new Date(post.timestamp).toLocaleDateString()}</span>
                                    </div>
                                    <div class="timeline-post-words">
                                        <span>📝</span>
                                        <span>${post.wordCount || 0} words</span>
                                    </div>
                                </div>
                                ${this.isAdminLoggedIn() ? `
                                    <div class="timeline-post-actions">
                                        <button class="timeline-action-btn edit" onclick="event.stopPropagation(); app.openEditModal(${post.id})">Edit</button>
                                        <button class="timeline-action-btn delete" onclick="event.stopPropagation(); app.confirmDeletePost(${post.id})">Delete</button>
                                    </div>
                                ` : ''}
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            toggleCenturySection(centuryValue) {
                try {
                    const section = document.querySelector(`[data-century="${centuryValue}"]`);
                    if (!section) return;

                    const header = section.querySelector('.century-header');
                    const content = section.querySelector('.century-content');
                    const isExpanded = header.classList.contains('active');

                    // Close all other sections
                    document.querySelectorAll('.century-header.active').forEach(activeHeader => {
                        if (activeHeader !== header) {
                            activeHeader.classList.remove('active');
                            const activeContent = activeHeader.parentElement.querySelector('.century-content');
                            const activeInner = activeContent.querySelector('.century-inner');

                            activeContent.classList.remove('expanded');
                            activeContent.style.maxHeight = '0px';

                            // Reset inner styling for other sections
                            if (activeInner) {
                                activeInner.style.transition = '';
                                activeInner.style.opacity = '';
                                activeInner.style.transform = '';
                            }
                        }
                    });

                    if (isExpanded) {
                        // Collapse this section
                        header.classList.remove('active');
                        content.classList.remove('expanded');
                        content.style.maxHeight = '0px';

                        // Reset inner styling
                        const inner = content.querySelector('.century-inner');
                        if (inner) {
                            inner.style.transition = '';
                            inner.style.opacity = '';
                            inner.style.transform = '';
                        }
                    } else {
                        // Expand this section
                        header.classList.add('active');
                        content.classList.add('expanded');

                        // Calculate and set the actual height for smooth animation
                        const inner = content.querySelector('.century-inner');
                        if (inner) {
                            const height = inner.scrollHeight + 20; // Add extra padding for smooth animation
                            content.style.maxHeight = height + 'px';

                            // Add a subtle fade-in effect for the content
                            inner.style.opacity = '0';
                            inner.style.transform = 'translateY(-10px)';

                            setTimeout(() => {
                                inner.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
                                inner.style.opacity = '1';
                                inner.style.transform = 'translateY(0)';
                            }, 100);
                        }
                    }

                    // Update activity if admin is logged in
                    if (this.isAdminLoggedIn()) {
                        this.lastActivity = Date.now();
                    }
                } catch (error) {
                    console.error('Error toggling century section:', error);
                }
            }

            viewTimelinePost(postId) {
                try {
                    const post = this.posts.find(p => p.id === postId);
                    if (!post) {
                        this.showErrorMessage('Post not found.');
                        return;
                    }

                    // Populate the modal with post data
                    const titleElement = document.getElementById('postViewTitle');
                    const contentElement = document.getElementById('postViewContent');
                    const metaElement = document.getElementById('postViewMeta');

                    if (!titleElement || !contentElement || !metaElement) {
                        console.error('Modal elements not found');
                        return;
                    }

                    titleElement.textContent = post.title;
                    contentElement.textContent = post.content;

                    // Create meta information
                    const metaHtml = `
                        <div class="post-view-meta-item">
                            <span>📅</span>
                            <span>Posted on ${post.dateString}</span>
                        </div>
                        <div class="post-view-meta-item">
                            <span>📝</span>
                            <span>${post.wordCount || 0} words</span>
                        </div>
                        ${post.century ? `
                            <div class="post-view-meta-item">
                                <span class="post-view-century">${this.getCenturyDisplayName(post.century)}</span>
                            </div>
                        ` : ''}
                        ${post.lastModified !== post.timestamp ? `
                            <div class="post-view-meta-item">
                                <span>✏️</span>
                                <span>Edited ${new Date(post.lastModified).toLocaleDateString()}</span>
                            </div>
                        ` : ''}
                    `;

                    metaElement.innerHTML = metaHtml;

                    // Show the modal
                    const modal = document.getElementById('postViewModal');
                    if (modal) {
                        modal.style.display = 'block';
                        document.body.style.overflow = 'hidden';
                    }

                    // Update activity if admin is logged in
                    if (this.isAdminLoggedIn()) {
                        this.lastActivity = Date.now();
                    }
                } catch (error) {
                    console.error('Error viewing timeline post:', error);
                    this.showErrorMessage('Error opening post. Please try again.');
                }
            }

            getCenturyDisplayName(centuryValue) {
                const centuries = this.generateCenturyOptions();
                const century = centuries.find(c => c.value === centuryValue);
                return century ? century.display : centuryValue;
            }

            // Rate Limiting System
            initRateLimiting() {
                const attempts = localStorage.getItem('adminLoginAttempts');
                const lockoutEnd = localStorage.getItem('adminLockoutEnd');

                if (lockoutEnd && Date.now() < parseInt(lockoutEnd)) {
                    this.startLockoutTimer(parseInt(lockoutEnd));
                } else {
                    localStorage.removeItem('adminLockoutEnd');
                    localStorage.setItem('adminLoginAttempts', '0');
                }
            }

            recordLoginAttempt(success = false) {
                const attempts = parseInt(localStorage.getItem('adminLoginAttempts') || '0');
                const newAttempts = success ? 0 : attempts + 1;

                localStorage.setItem('adminLoginAttempts', newAttempts.toString());

                if (!success) {
                    this.logSecurityEvent('LOGIN_FAILED', `Failed attempt ${newAttempts}/3`);

                    if (newAttempts >= this.securityConfig.maxLoginAttempts) {
                        const lockoutEnd = Date.now() + this.securityConfig.lockoutDuration;
                        localStorage.setItem('adminLockoutEnd', lockoutEnd.toString());
                        this.startLockoutTimer(lockoutEnd);
                        this.logSecurityEvent('ACCOUNT_LOCKED', `Locked for 15 minutes`);
                        return false;
                    }
                }
                return true;
            }

            startLockoutTimer(lockoutEnd) {
                const warningDiv = document.getElementById('rateLimitWarning');
                const timerSpan = document.getElementById('lockoutTimer');
                const loginForm = document.getElementById('adminLoginForm');

                warningDiv.classList.add('active');
                loginForm.style.pointerEvents = 'none';
                loginForm.style.opacity = '0.5';

                this.lockoutTimer = setInterval(() => {
                    const remaining = lockoutEnd - Date.now();

                    if (remaining <= 0) {
                        clearInterval(this.lockoutTimer);
                        warningDiv.classList.remove('active');
                        loginForm.style.pointerEvents = 'auto';
                        loginForm.style.opacity = '1';
                        localStorage.removeItem('adminLockoutEnd');
                        localStorage.setItem('adminLoginAttempts', '0');
                        this.logSecurityEvent('LOCKOUT_EXPIRED', 'Account unlocked');
                        return;
                    }

                    const minutes = Math.floor(remaining / 60000);
                    const seconds = Math.floor((remaining % 60000) / 1000);
                    timerSpan.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                }, 1000);
            }

            isRateLimited() {
                const lockoutEnd = localStorage.getItem('adminLockoutEnd');
                return lockoutEnd && Date.now() < parseInt(lockoutEnd);
            }

            // Session Security System
            generateSessionToken() {
                const token = btoa(
                    Date.now() +
                    Math.random() +
                    this.currentIP +
                    navigator.userAgent
                ).replace(/[+=]/g, '');

                this.sessionToken = token;
                this.securityConfig.sessionTokens.add(token);
                sessionStorage.setItem('adminSessionToken', token);
                return token;
            }

            validateSessionToken() {
                const token = sessionStorage.getItem('adminSessionToken');
                if (!token || !this.securityConfig.sessionTokens.has(token)) {
                    this.triggerSecurityViolation('INVALID_SESSION_TOKEN');
                    return false;
                }
                return true;
            }

            triggerSecurityViolation(reason) {
                this.logSecurityEvent('SECURITY_VIOLATION', reason);
                this.emergencyLogout();
                this.showErrorMessage('Security violation detected. Session terminated.');
            }

            emergencyLogout() {
                // Clear all admin data
                sessionStorage.clear();
                localStorage.removeItem('adminPersistent');
                this.securityConfig.sessionTokens.clear();
                this.sessionToken = null;
                this.currentEditingPost = null;
                this.clearTimers();
                this.updateAdminUI();
            }

            hashPassword(password) {
                let hash = 0;
                const salt = 'myblogsalt2024';
                const combined = password + salt;
                for (let i = 0; i < combined.length; i++) {
                    const char = combined.charCodeAt(i);
                    hash = ((hash << 5) - hash) + char;
                    hash = hash & hash;
                }
                return hash.toString(36);
            }

            isAdminLoggedIn() {
                const sessionAuth = sessionStorage.getItem('adminLoggedIn') === 'true';
                const persistAuth = localStorage.getItem('adminPersistent') === 'true';
                return sessionAuth || persistAuth;
            }

            checkExistingSession() {
                if (localStorage.getItem('adminPersistent') !== 'true') {
                    sessionStorage.removeItem('adminLoggedIn');
                }
                this.updateAdminUI();
                if (this.isAdminLoggedIn()) {
                    this.startSessionTimer();
                }
            }

            setUserMode() {
                document.getElementById('adminToolbar').classList.remove('active');
                this.updateAdminStats();
            }

            setAdminMode() {
                document.getElementById('adminToolbar').classList.add('active');
                this.adminLoginTime = Date.now();
                this.startSessionDurationCounter();
                this.updateAdminStats();
            }

            updateAdminUI() {
                const createPostBtn = document.getElementById('createPostBtn');
                const adminStatus = document.getElementById('adminStatus');
                const headerIndicator = document.getElementById('headerAdminIndicator');
                const footerAdminLink = document.getElementById('footerAdminLink');

                if (this.isAdminLoggedIn()) {
                    this.setAdminMode();
                    createPostBtn.style.display = 'block';
                    adminStatus.style.display = 'flex';
                    headerIndicator.classList.add('active');
                    footerAdminLink.style.display = 'none';
                } else {
                    this.setUserMode();
                    createPostBtn.style.display = 'none';
                    adminStatus.style.display = 'none';
                    headerIndicator.classList.remove('active');
                    footerAdminLink.style.display = 'inline';
                }

                // Refresh timeline to show/hide admin buttons
                this.populateTimelineTab();
            }

            updateAdminStats() {
                if (!this.isAdminLoggedIn()) return;

                const totalPosts = this.posts.length;
                document.getElementById('totalPostsCount').textContent = `Posts: ${totalPosts}`;
            }

            calculateStorageUsage() {
                const data = JSON.stringify(this.posts);
                const sizeInBytes = new Blob([data]).size;
                if (sizeInBytes < 1024) return sizeInBytes + 'B';
                if (sizeInBytes < 1024 * 1024) return Math.round(sizeInBytes / 1024) + 'KB';
                return Math.round(sizeInBytes / (1024 * 1024)) + 'MB';
            }

            startSessionDurationCounter() {
                if (this.sessionDurationInterval) {
                    clearInterval(this.sessionDurationInterval);
                }

                this.sessionDurationInterval = setInterval(() => {
                    if (this.adminLoginTime) {
                        const duration = Date.now() - this.adminLoginTime;
                        const minutes = Math.floor(duration / 60000);
                        const seconds = Math.floor((duration % 60000) / 1000);
                        document.getElementById('adminSince').textContent =
                            `Session: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    }
                }, 1000);
            }

            initActivityTracking() {
                const events = ['mousedown', 'mousemove', 'keypress', 'scroll', 'touchstart', 'click'];
                events.forEach(event => {
                    document.addEventListener(event, () => {
                        if (this.isAdminLoggedIn()) {
                            this.lastActivity = Date.now();
                            this.resetSessionTimer();
                        }
                    }, true);
                });
            }

            initSecurityFeatures() {
                const adminModal = document.getElementById('adminLoginModal');
                adminModal.addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    return false;
                });

                setInterval(() => {
                    if (this.isAdminLoggedIn() && this.isDevToolsOpen()) {
                        this.showSuccessMessage('Developer tools detected. Logging out for security.');
                        this.logout();
                    }
                }, 1000);
            }

            isDevToolsOpen() {
                const threshold = 160;
                return window.outerHeight - window.innerHeight > threshold ||
                    window.outerWidth - window.innerWidth > threshold;
            }

            startSessionTimer() {
                this.clearTimers();

                this.warningTimer = setTimeout(() => {
                    this.showTimeoutWarning();
                }, this.sessionTimeout - this.warningTime);

                this.sessionTimer = setTimeout(() => {
                    this.logout();
                    this.showSuccessMessage('Session expired due to inactivity.');
                }, this.sessionTimeout);
            }

            resetSessionTimer() {
                if (this.isAdminLoggedIn()) {
                    this.hideTimeoutWarning();
                    this.startSessionTimer();
                }
            }

            clearTimers() {
                if (this.sessionTimer) clearTimeout(this.sessionTimer);
                if (this.warningTimer) clearTimeout(this.warningTimer);
                if (this.countdownInterval) clearInterval(this.countdownInterval);
            }

            showTimeoutWarning() {
                const warning = document.getElementById('timeoutWarning');
                warning.style.display = 'block';

                let timeLeft = this.warningTime / 1000;
                const countdown = document.getElementById('timeoutCountdown');

                this.countdownInterval = setInterval(() => {
                    const minutes = Math.floor(timeLeft / 60);
                    const seconds = timeLeft % 60;
                    countdown.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                    timeLeft--;

                    if (timeLeft < 0) {
                        clearInterval(this.countdownInterval);
                    }
                }, 1000);
            }

            hideTimeoutWarning() {
                const warning = document.getElementById('timeoutWarning');
                warning.style.display = 'none';
                if (this.countdownInterval) {
                    clearInterval(this.countdownInterval);
                }
            }

            initEventListeners() {
                const createPostBtn = document.getElementById('createPostBtn');
                const closeModal = document.getElementById('closeModal');
                const cancelBtn = document.getElementById('cancelBtn');
                const postForm = document.getElementById('postForm');
                const modal = document.getElementById('createPostModal');

                const footerAdminLink = document.getElementById('footerAdminLink');
                const closeAdminModal = document.getElementById('closeAdminModal');
                const cancelAdminBtn = document.getElementById('cancelAdminBtn');
                const adminLoginForm = document.getElementById('adminLoginForm');
                const adminModal = document.getElementById('adminLoginModal');
                const logoutBtn = document.getElementById('logoutBtn');

                // Admin toolbar elements
                const dashboardToggle = document.getElementById('dashboardToggle');
                const adminCreatePostBtn = document.getElementById('adminCreatePostBtn');
                const adminLogoutBtn = document.getElementById('adminLogoutBtn');


                // Edit modal elements
                const editPostForm = document.getElementById('editPostForm');
                const closeEditModal = document.getElementById('closeEditModal');
                const cancelEditBtn = document.getElementById('cancelEditBtn');
                const editModal = document.getElementById('editPostModal');



                // Confirmation dialog elements
                const confirmCancel = document.getElementById('confirmCancel');
                const confirmProceed = document.getElementById('confirmProceed');

                const extendSessionBtn = document.getElementById('extendSession');
                const logoutNowBtn = document.getElementById('logoutNow');

                // Post view modal elements
                const postViewModal = document.getElementById('postViewModal');
                const closePostViewModal = document.getElementById('closePostViewModal');

                // Tab functionality
                const tabBtns = document.querySelectorAll('.tab-btn');

                // Main functionality
                createPostBtn.addEventListener('click', () => this.openModal());
                closeModal.addEventListener('click', () => this.closeModal());
                cancelBtn.addEventListener('click', () => this.closeModal());
                postForm.addEventListener('submit', (e) => this.handleSubmit(e));

                // Admin login
                footerAdminLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    this.openAdminModal();
                });
                closeAdminModal.addEventListener('click', () => this.closeAdminModal());
                cancelAdminBtn.addEventListener('click', () => this.closeAdminModal());
                adminLoginForm.addEventListener('submit', (e) => this.handleAdminLogin(e));
                logoutBtn.addEventListener('click', () => this.logout());

                // Admin toolbar
                dashboardToggle.addEventListener('click', () => this.toggleDashboard());
                adminCreatePostBtn.addEventListener('click', () => this.openModal());
                adminLogoutBtn.addEventListener('click', () => this.logout());


                // Edit modal
                editPostForm.addEventListener('submit', (e) => this.handleEditPost(e));
                closeEditModal.addEventListener('click', () => this.closeEditModal());
                cancelEditBtn.addEventListener('click', () => this.closeEditModal());

                // Dashboard


                // Confirmation dialog
                confirmCancel.addEventListener('click', () => this.hideConfirmationDialog());
                confirmProceed.addEventListener('click', () => this.executeConfirmAction());

                // Session management
                extendSessionBtn.addEventListener('click', () => this.extendSession());
                logoutNowBtn.addEventListener('click', () => this.logout());

                // Tab switching
                tabBtns.forEach(btn => {
                    btn.addEventListener('click', () => this.switchTab(btn.dataset.tab));
                });

                // Post view modal
                closePostViewModal.addEventListener('click', () => this.closePostViewModal());
                postViewModal.addEventListener('click', (e) => {
                    if (e.target === postViewModal) {
                        this.closePostViewModal();
                    }
                });

                // Modal handling
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        this.closeModal();
                    }
                });

                adminModal.addEventListener('click', (e) => {
                    if (e.target === adminModal) {
                        this.closeAdminModal();
                    }
                });

                editModal.addEventListener('click', (e) => {
                    if (e.target === editModal) {
                        this.closeEditModal();
                    }
                });

                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        this.closeModal();
                        this.closeAdminModal();
                        this.closeEditModal();
                        this.closePostViewModal();
                        this.hideTimeoutWarning();
                        this.hideConfirmationDialog();
                    }
                });
            }

            extendSession() {
                this.lastActivity = Date.now();
                this.resetSessionTimer();
                this.hideTimeoutWarning();
                this.showSuccessMessage('Session extended successfully!');
            }

            switchTab(tabName) {
                try {
                    // Remove active class from all tab buttons
                    document.querySelectorAll('.tab-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });

                    // Remove active class from all tab panes
                    document.querySelectorAll('.tab-pane').forEach(pane => {
                        pane.classList.remove('active');
                    });

                    // Add active class to clicked tab button
                    const targetBtn = document.querySelector(`[data-tab="${tabName}"]`);
                    if (targetBtn) {
                        targetBtn.classList.add('active');
                    }

                    // Show corresponding tab pane
                    const targetPane = document.getElementById(`${tabName}Tab`);
                    if (targetPane) {
                        targetPane.classList.add('active');
                    }

                    // Update activity if admin is logged in
                    if (this.isAdminLoggedIn()) {
                        this.lastActivity = Date.now();
                    }
                } catch (error) {
                    console.error('Error switching tabs:', error);
                }
            }

            openModal() {
                const modal = document.getElementById('createPostModal');
                modal.style.display = 'block';
                document.getElementById('postTitle').focus();
                document.body.style.overflow = 'hidden';
            }

            closeModal() {
                const modal = document.getElementById('createPostModal');
                modal.style.display = 'none';
                document.getElementById('postForm').reset();
                document.body.style.overflow = 'auto';
            }

            openAdminModal() {
                const modal = document.getElementById('adminLoginModal');
                modal.style.display = 'block';
                document.getElementById('adminPassword').focus();
                document.body.style.overflow = 'hidden';
                document.getElementById('loginError').style.display = 'none';
            }

            closeAdminModal() {
                const modal = document.getElementById('adminLoginModal');
                modal.style.display = 'none';
                document.getElementById('adminLoginForm').reset();
                document.getElementById('loginError').style.display = 'none';
                document.body.style.overflow = 'auto';
            }

            handleAdminLogin(e) {
                e.preventDefault();

                if (this.isRateLimited()) {
                    this.showErrorMessage('Account is locked due to too many failed attempts.');
                    return;
                }

                const password = document.getElementById('adminPassword').value;
                const errorDiv = document.getElementById('loginError');

                if (password === 'Pacers33!!!') {
                    if (!this.recordLoginAttempt(true)) return;

                    sessionStorage.setItem('adminLoggedIn', 'true');
                    localStorage.setItem('adminPersistent', 'true');

                    this.lastActivity = Date.now();
                    this.startSessionTimer();
                    this.updateAdminUI();
                    this.closeAdminModal();

                    this.logSecurityEvent('LOGIN_SUCCESS', 'Admin login successful');
                    this.showSuccessMessage('Successfully logged in as admin!');
                } else {
                    if (!this.recordLoginAttempt(false)) return;

                    errorDiv.style.display = 'block';
                    document.getElementById('adminPassword').value = '';
                    document.getElementById('adminPassword').focus();
                }
            }

            // Activity Logging System
            logSecurityEvent(action, details = '') {
                if (!this.securityConfig.enableActivityLogging) return;

                const logs = this.getActivityLogs();
                const logEntry = {
                    timestamp: new Date().toISOString(),
                    action: action,
                    details: details,
                    ip: this.currentIP || 'Unknown',
                    userAgent: navigator.userAgent.substring(0, 50) + '...'
                };

                logs.unshift(logEntry);

                // Keep only last 50 entries
                if (logs.length > 50) {
                    logs.splice(50);
                }

                localStorage.setItem('adminActivityLogs', JSON.stringify(logs));
            }

            getActivityLogs() {
                try {
                    const logs = localStorage.getItem('adminActivityLogs');
                    return logs ? JSON.parse(logs) : [];
                } catch (error) {
                    return [];
                }
            }





            updateSecurityIndicator() {
                const indicator = document.getElementById('securityIndicator');
                if (this.securityConfig.enableIPRestriction && this.currentIP) {
                    indicator.classList.add('active');
                }
            }





            editPost(postId) {
                const post = this.posts.find(p => p.id === postId);
                if (!post) return;

                const newTitle = prompt('Edit title:', post.title);
                if (newTitle === null) return;

                const newContent = prompt('Edit content:', post.content);
                if (newContent === null) return;

                if (newTitle.trim() && newContent.trim()) {
                    post.title = newTitle.trim();
                    post.content = newContent.trim();
                    this.savePosts();
                    this.renderPosts();
                    this.updateAdminStats();
                    this.showSuccessMessage('Post updated successfully!');
                }
            }

            deletePost(postId) {
                if (!confirm('Are you sure you want to delete this post? This action cannot be undone.')) {
                    return;
                }

                this.posts = this.posts.filter(p => p.id !== postId);
                this.savePosts();
                this.renderPosts();
                this.updateAdminStats();
                this.showSuccessMessage('Post deleted successfully!');
            }

            logout() {
                sessionStorage.removeItem('adminLoggedIn');
                localStorage.removeItem('adminPersistent');
                this.clearTimers();
                this.hideTimeoutWarning();
                if (this.sessionDurationInterval) {
                    clearInterval(this.sessionDurationInterval);
                }
                this.adminLoginTime = null;
                this.updateAdminUI();
                this.showSuccessMessage('Successfully logged out!');
            }

            handleSubmit(e) {
                e.preventDefault();

                if (!this.isAdminLoggedIn()) {
                    this.showErrorMessage('You must be logged in as admin to create posts.');
                    this.closeModal();
                    return;
                }

                const title = document.getElementById('postTitle').value.trim();
                const content = document.getElementById('postContent').value.trim();
                const century = document.getElementById('postCentury').value;

                if (!title || !content) {
                    this.showErrorMessage('Please fill in both title and content.');
                    return;
                }

                try {
                    const now = new Date().toISOString();
                    const post = {
                        id: Date.now(),
                        title,
                        content,
                        century: century || null,
                        timestamp: now,
                        lastModified: now,
                        wordCount: this.countWords(content),
                        dateString: new Date().toLocaleDateString('en-US', {
                            year: 'numeric',
                            month: 'long',
                            day: 'numeric',
                            hour: '2-digit',
                            minute: '2-digit'
                        })
                    };

                    this.posts.unshift(post);
                    this.savePosts();
                    this.renderPosts();
                    this.populateTimelineTab();
                    this.closeModal();
                    this.updateAdminStats();

                    this.showSuccessMessage('Post created successfully!');
                } catch (error) {
                    this.showErrorMessage('Error creating post: ' + error.message);
                }
            }

            showSuccessMessage(message) {
                this.showToast(message, 'var(--accent)');
            }

            showErrorMessage(message) {
                this.showToast(message, '#ef4444');
            }

            showToast(message, backgroundColor) {
                const toast = document.createElement('div');
                toast.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: ${backgroundColor};
                    color: white;
                    padding: 15px 20px;
                    border-radius: 6px;
                    z-index: 2000;
                    font-weight: 500;
                    box-shadow: 0 4px 12px var(--shadow);
                    transform: translateX(100%);
                    transition: transform 0.3s ease;
                    max-width: 350px;
                    word-wrap: break-word;
                `;
                toast.textContent = message;
                document.body.appendChild(toast);

                setTimeout(() => {
                    toast.style.transform = 'translateX(0)';
                }, 100);

                setTimeout(() => {
                    toast.style.transform = 'translateX(100%)';
                    setTimeout(() => {
                        if (document.body.contains(toast)) {
                            document.body.removeChild(toast);
                        }
                    }, 300);
                }, 4000);
            }

            renderPosts() {
                const container = document.getElementById('postsContainer');

                if (this.posts.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <h3>No posts yet</h3>
                            <p>Click "Create Post" to write your first blog post!</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = this.posts.map(post => {
                    const createdDate = new Date(post.timestamp).toLocaleDateString();
                    const modifiedDate = new Date(post.lastModified).toLocaleDateString();
                    const isModified = post.lastModified !== post.timestamp;

                    return `
                        <article class="post" data-post-id="${post.id}">
                            ${this.isAdminLoggedIn() ? `
                                <div class="post-actions">
                                    <button class="post-action-btn edit" onclick="app.openEditModal(${post.id})">Edit</button>
                                    <button class="post-action-btn delete" onclick="app.confirmDeletePost(${post.id})">Delete</button>
                                </div>
                            ` : ''}
                            <div class="post-header">
                                <h2 class="post-title">${this.escapeHtml(post.title)}</h2>
                                <div class="post-meta">Posted on ${post.dateString}${isModified ? ` (edited ${modifiedDate})` : ''}</div>
                            </div>
                            <div class="post-content">${this.escapeHtml(post.content)}</div>
                            ${this.isAdminLoggedIn() ? `
                                <div class="post-analytics">
                                    <div class="analytics-item">
                                        <span class="analytics-icon">📝</span>
                                        <span>${post.wordCount || 0} words</span>
                                    </div>
                                    <div class="analytics-item">
                                        <span class="analytics-icon">📅</span>
                                        <span>Created: ${createdDate}</span>
                                    </div>
                                    ${isModified ? `
                                        <div class="analytics-item">
                                            <span class="analytics-icon">✏️</span>
                                            <span>Modified: ${modifiedDate}</span>
                                        </div>
                                    ` : ''}
                                </div>
                            ` : ''}
                        </article>
                    `;
                }).join('');
            }

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }

            // Edit Post Methods
            openEditModal(postId) {
                if (!this.isAdminLoggedIn()) return;

                const post = this.posts.find(p => p.id === postId);
                if (!post) {
                    this.showErrorMessage('Post not found.');
                    return;
                }

                this.currentEditingPost = post;
                document.getElementById('editPostTitle').value = post.title;
                document.getElementById('editPostContent').value = post.content;
                document.getElementById('editPostCentury').value = post.century || '';
                document.getElementById('editPostModal').style.display = 'block';
                document.getElementById('editPostTitle').focus();
                document.body.style.overflow = 'hidden';
            }

            closeEditModal() {
                document.getElementById('editPostModal').style.display = 'none';
                document.getElementById('editPostForm').reset();
                document.body.style.overflow = 'auto';
                this.currentEditingPost = null;
            }

            closePostViewModal() {
                try {
                    const modal = document.getElementById('postViewModal');
                    if (modal) {
                        modal.style.display = 'none';
                    }
                    document.body.style.overflow = 'auto';
                } catch (error) {
                    console.error('Error closing post view modal:', error);
                }
            }

            handleEditPost(e) {
                e.preventDefault();

                if (!this.currentEditingPost) {
                    this.showErrorMessage('No post selected for editing.');
                    return;
                }

                const title = document.getElementById('editPostTitle').value.trim();
                const content = document.getElementById('editPostContent').value.trim();
                const century = document.getElementById('editPostCentury').value;

                if (!title || !content) {
                    this.showErrorMessage('Please fill in both title and content.');
                    return;
                }

                try {
                    this.currentEditingPost.title = title;
                    this.currentEditingPost.content = content;
                    this.currentEditingPost.century = century || null;
                    this.currentEditingPost.lastModified = new Date().toISOString();
                    this.currentEditingPost.wordCount = this.countWords(content);

                    this.savePosts();
                    this.renderPosts();
                    this.populateTimelineTab();
                    this.closeEditModal();
                    this.updateAdminStats();

                    this.logSecurityEvent('POST_EDITED', `Edited: "${title}"`);
                    this.showSuccessMessage('Post updated successfully!');
                } catch (error) {
                    this.showErrorMessage('Error updating post: ' + error.message);
                }
            }

            // Delete Post Methods
            confirmDeletePost(postId) {
                if (!this.isAdminLoggedIn()) return;

                const post = this.posts.find(p => p.id === postId);
                if (!post) {
                    this.showErrorMessage('Post not found.');
                    return;
                }

                this.showConfirmationDialog(
                    'Delete Post',
                    `Are you sure you want to delete "${post.title}"? This action cannot be undone.`,
                    () => this.deletePost(postId)
                );
            }

            deletePost(postId) {
                try {
                    const initialCount = this.posts.length;
                    this.posts = this.posts.filter(p => p.id !== postId);

                    if (this.posts.length === initialCount) {
                        this.showErrorMessage('Post not found or already deleted.');
                        return;
                    }

                    this.savePosts();
                    this.renderPosts();
                    this.populateTimelineTab();
                    this.updateAdminStats();
                    this.showSuccessMessage('Post deleted successfully!');
                } catch (error) {
                    this.showErrorMessage('Error deleting post: ' + error.message);
                }
            }

            // Dashboard Methods
            toggleDashboard() {
                const dashboard = document.getElementById('adminDashboard');
                const isActive = dashboard.classList.contains('active');

                if (isActive) {
                    dashboard.classList.remove('active');
                } else {
                    this.updateDashboardStats();
                    dashboard.classList.add('active');
                }
            }

            updateDashboardStats() {
                if (!this.isAdminLoggedIn()) return;

                const totalPosts = this.posts.length;
                const totalWords = this.posts.reduce((sum, post) => sum + (post.wordCount || 0), 0);
                const avgWords = totalPosts > 0 ? Math.round(totalWords / totalPosts) : 0;
                const dataSize = this.calculateStorageUsage();

                document.getElementById('dashTotalPosts').textContent = totalPosts;
                document.getElementById('dashTotalWords').textContent = totalWords.toLocaleString();
                document.getElementById('dashAvgWords').textContent = avgWords;
                document.getElementById('dashDataSize').textContent = dataSize;

                this.updateCenturyStats();
            }

            updateCenturyStats() {
                if (!this.isAdminLoggedIn()) return;

                const centuryStatsContainer = document.getElementById('centuryStats');
                if (!centuryStatsContainer) return;

                const centuries = this.generateCenturyOptions();
                const centuryPostCounts = {};

                // Count posts per century
                centuries.forEach(century => {
                    centuryPostCounts[century.value] = this.getPostsByCentury(century.value).length;
                });

                // Count posts with no century
                const postsWithoutCentury = this.posts.filter(post => !post.century).length;

                centuryStatsContainer.innerHTML = `
                    ${postsWithoutCentury > 0 ? `
                        <div class="century-stat-item">
                            <div class="century-stat-value">${postsWithoutCentury}</div>
                            <div class="century-stat-label">No Century</div>
                        </div>
                    ` : ''}
                    ${centuries.map(century => {
                    const count = centuryPostCounts[century.value];
                    return `
                            <div class="century-stat-item ${count === 0 ? 'century-stat-empty' : ''}">
                                <div class="century-stat-value">${count}</div>
                                <div class="century-stat-label">${century.display}</div>
                            </div>
                        `;
                }).join('')}
                `;
            }

            loadPosts() {
                try {
                    const stored = localStorage.getItem('blogPosts');
                    return stored ? JSON.parse(stored) : [];
                } catch (error) {
                    console.error('Error loading posts:', error);
                    this.showErrorMessage('Error loading posts from storage.');
                    return [];
                }
            }

            savePosts() {
                try {
                    localStorage.setItem('blogPosts', JSON.stringify(this.posts));
                } catch (error) {
                    console.error('Error saving posts:', error);
                    alert('Error saving posts. Please try again.');
                }
            }

            // Export/Import Methods
            exportPosts() {
                if (this.posts.length === 0) {
                    this.showErrorMessage('No posts to export!');
                    return;
                }

                try {
                    const exportData = {
                        exportDate: new Date().toISOString(),
                        totalPosts: this.posts.length,
                        version: '2.0',
                        posts: this.posts
                    };

                    const dataStr = JSON.stringify(exportData, null, 2);
                    const dataBlob = new Blob([dataStr], { type: 'application/json' });

                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(dataBlob);
                    link.download = `blog-posts-${new Date().toISOString().split('T')[0]}.json`;
                    link.click();

                    URL.revokeObjectURL(link.href);
                    this.showSuccessMessage('Posts exported successfully!');
                } catch (error) {
                    this.showErrorMessage('Error exporting posts: ' + error.message);
                }
            }









            // Confirmation Dialog Methods
            showConfirmationDialog(title, message, action) {
                document.getElementById('confirmTitle').textContent = title;
                document.getElementById('confirmMessage').textContent = message;
                document.getElementById('confirmationDialog').classList.add('active');
                this.pendingConfirmAction = action;
            }

            hideConfirmationDialog() {
                document.getElementById('confirmationDialog').classList.remove('active');
                this.pendingConfirmAction = null;
            }

            executeConfirmAction() {
                if (this.pendingConfirmAction) {
                    this.pendingConfirmAction();
                    this.hideConfirmationDialog();
                }
            }




            // Enhanced logout with security logging
            logout() {
                this.logSecurityEvent('ADMIN_LOGOUT', 'Admin session ended');

                sessionStorage.removeItem('adminLoggedIn');
                localStorage.removeItem('adminPersistent');
                this.clearTimers();
                this.hideTimeoutWarning();
                if (this.sessionDurationInterval) {
                    clearInterval(this.sessionDurationInterval);
                }
                if (this.lockoutTimer) {
                    clearInterval(this.lockoutTimer);
                }

                // Clear session security
                this.securityConfig.sessionTokens.clear();
                sessionStorage.removeItem('adminSessionToken');

                this.adminLoginTime = null;
                this.sessionToken = null;
                this.updateAdminUI();
                this.showSuccessMessage('Successfully logged out!');
            }
        }

        let app;
        document.addEventListener('DOMContentLoaded', () => {
            app = new BlogApp();
        });
    </script>
</body>

</html>